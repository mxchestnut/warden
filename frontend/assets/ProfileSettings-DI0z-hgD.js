import{r as n,j as e}from"./editor-B5c-jJ5G.js";import{a as v}from"./index-C4-c_iSx.js";import{N as b}from"./Navigation-BkxSZNXP.js";import{k as P}from"./lucide-Dju06cgn.js";import"./matrix-DowZW4Yz.js";function T(){const[r,f]=n.useState(null),[C,h]=n.useState(!0),[t,u]=n.useState("profile"),[k,S]=n.useState(!1),[g,a]=n.useState(null),[y,c]=n.useState(null),[s,x]=n.useState(""),[l,m]=n.useState(""),[i,d]=n.useState(!1);n.useEffect(()=>{p()},[]);const p=async()=>{try{h(!0);const o=await v.getCurrentUser();o&&f({...o,pathCompanionConnected:!!o.pathcompanionUsername,pathCompanionUsername:o.pathcompanionUsername||""})}catch(o){console.error("Failed to load user:",o),a("Failed to load profile")}finally{h(!1)}},j=async()=>{if(!s||!l){a("Please enter both username and password");return}try{d(!0),a(null),c(null);const o=await fetch("/api/auth/pathcompanion/connect",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:s,password:l})});if(!o.ok){const w=await o.json();throw new Error(w.error||"Failed to connect PathCompanion account")}const D=await o.json();c("PathCompanion account connected successfully!"),m(""),await p()}catch(o){a(o instanceof Error?o.message:"Failed to connect PathCompanion")}finally{d(!1)}},B=async()=>{if(confirm("Are you sure you want to disconnect your PathCompanion account?"))try{if(d(!0),a(null),c(null),!(await fetch("/api/auth/pathcompanion/disconnect",{method:"POST",credentials:"include"})).ok)throw new Error("Failed to disconnect PathCompanion account");c("PathCompanion account disconnected successfully"),x(""),m(""),await p()}catch(o){a(o instanceof Error?o.message:"Failed to disconnect PathCompanion")}finally{d(!1)}};return C?e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#37322E"},children:[e.jsx(b,{user:r}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:"4rem"},children:e.jsx("p",{style:{color:"white"},children:"Loading..."})})]}):e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#37322E"},children:[e.jsx(b,{user:r}),e.jsxs("div",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h1",{style:{fontSize:"2rem",fontWeight:"bold",color:"white",marginBottom:"0.5rem"},children:"Profile & Settings"}),e.jsx("p",{style:{color:"#B3B2B0"},children:"Manage your account settings and integrations"})]}),g&&e.jsx("div",{style:{backgroundColor:"#7F1D1D",color:"white",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1rem"},children:g}),y&&e.jsx("div",{style:{backgroundColor:"#065F46",color:"white",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1rem"},children:y}),e.jsx("div",{style:{borderBottom:"2px solid #4A4540",marginBottom:"2rem"},children:e.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[e.jsx("button",{onClick:()=>u("profile"),style:{padding:"1rem",color:t==="profile"?"#D4AF37":"#B3B2B0",borderBottom:t==="profile"?"2px solid #D4AF37":"none",background:"none",border:"none",cursor:"pointer",fontWeight:t==="profile"?"bold":"normal"},children:"Profile"}),e.jsx("button",{onClick:()=>u("pathcompanion"),style:{padding:"1rem",color:t==="pathcompanion"?"#D4AF37":"#B3B2B0",borderBottom:t==="pathcompanion"?"2px solid #D4AF37":"none",background:"none",border:"none",cursor:"pointer",fontWeight:t==="pathcompanion"?"bold":"normal"},children:"PathCompanion"})]})}),t==="profile"&&r&&e.jsxs("div",{style:{backgroundColor:"#4A4540",borderRadius:"0.75rem",padding:"2rem"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"white",marginBottom:"1.5rem"},children:"Account Information"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#B3B2B0",marginBottom:"0.5rem"},children:"Username"}),e.jsx("input",{type:"text",value:r.username,disabled:!0,style:{width:"100%",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #666",backgroundColor:"#333",color:"#888",cursor:"not-allowed"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#B3B2B0",marginBottom:"0.5rem"},children:"Account ID"}),e.jsx("input",{type:"text",value:r.id,disabled:!0,style:{width:"100%",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #666",backgroundColor:"#333",color:"#888",cursor:"not-allowed"}}),e.jsx("p",{style:{color:"#B3B2B0",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Use this ID in Discord to sync your profile with the Warden bot"})]}),r.isAdmin&&e.jsx("div",{style:{backgroundColor:"#B34B0C",color:"white",padding:"0.75rem 1rem",borderRadius:"0.5rem",display:"inline-block"},children:e.jsx("strong",{children:"Admin Account"})})]})]}),t==="pathcompanion"&&e.jsxs("div",{style:{backgroundColor:"#4A4540",borderRadius:"0.75rem",padding:"2rem"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"white",marginBottom:"1rem"},children:"PathCompanion Integration"}),e.jsx("p",{style:{color:"#B3B2B0",marginBottom:"1.5rem"},children:"Connect your PathCompanion account to sync characters and access game features."}),r?.pathCompanionConnected?e.jsxs("div",{children:[e.jsxs("div",{style:{backgroundColor:"#065F46",color:"white",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(P,{className:"w-5 h-5"}),e.jsxs("span",{children:["Connected as ",e.jsx("strong",{children:r.pathCompanionUsername})]})]}),e.jsx("button",{onClick:B,disabled:i,style:{backgroundColor:"#7F1D1D",color:"white",padding:"0.75rem 1.5rem",borderRadius:"0.5rem",border:"none",cursor:i?"not-allowed":"pointer",opacity:i?.6:1},children:i?"Disconnecting...":"Disconnect PathCompanion"})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#B3B2B0",marginBottom:"0.5rem"},children:"PathCompanion Username"}),e.jsx("input",{type:"text",value:s,onChange:o=>x(o.target.value),placeholder:"Enter your PathCompanion username",style:{width:"100%",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #666",backgroundColor:"#333",color:"white"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#B3B2B0",marginBottom:"0.5rem"},children:"PathCompanion Password"}),e.jsx("input",{type:"password",value:l,onChange:o=>m(o.target.value),placeholder:"Enter your PathCompanion password",style:{width:"100%",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #666",backgroundColor:"#333",color:"white"}})]}),e.jsx("button",{onClick:j,disabled:i||!s||!l,style:{backgroundColor:"#B34B0C",color:"white",padding:"0.75rem 1.5rem",borderRadius:"0.5rem",border:"none",cursor:i||!s||!l?"not-allowed":"pointer",opacity:i||!s||!l?.6:1},children:i?"Connecting...":"Connect PathCompanion"})]})]})]})]})}export{T as ProfileSettings};
