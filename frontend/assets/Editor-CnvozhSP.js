import{r as De,j as y}from"./index-BcQW7OjF.js";import{N as O,n as Ie,R as Be,m as W,P as ve,a as se,k as Oe,S as L,b as Ve,T as E,F as R,c as $,D as Q,d as Z,e as Pe,f as Fe,g as qe,h as Ke,i as Ue,E as ke,j as Xe,l as Je,M as ie,o as Ye,p as Ge,u as Qe,q as Ze,r as et,s as tt,t as nt}from"./index-DAQtT9J5.js";import{c as A}from"./Dashboard-CwAWU9Zg.js";import{L as ot}from"./list-Cf5cEqwx.js";import"./with-selector-BJfYQDNp.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"9100b80d8d3578ae8a7e4dcad47fa28b1cb8d4d7"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f68d55e0-827e-4be6-8177-77c7101207d0",e._sentryDebugIdIdentifier="sentry-dbid-f68d55e0-827e-4be6-8177-77c7101207d0")})()}catch{}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=A("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=A("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=A("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=A("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=A("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=A("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=A("Heading1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=A("Heading2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=A("Heading3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=A("Highlighter",[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=A("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=A("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=A("Quote",[["path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z",key:"4rm80e"}],["path",{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z",key:"10za9r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=A("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=A("Strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=A("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);var Ct=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,xt=O.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{},resize:!1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",W(this.options.HTMLAttributes,e)]},parseMarkdown:(e,t)=>t.createNode("image",{src:e.href,title:e.title,alt:e.text}),renderMarkdown:e=>{var t,n,o,l,r,s;const a=(n=(t=e.attrs)==null?void 0:t.src)!=null?n:"",i=(l=(o=e.attrs)==null?void 0:o.alt)!=null?l:"",c=(s=(r=e.attrs)==null?void 0:r.title)!=null?s:"";return c?`![${i}](${a} "${c}")`:`![${i}](${a})`},addNodeView(){if(!this.options.resize||!this.options.resize.enabled||typeof document>"u")return null;const{directions:e,minWidth:t,minHeight:n,alwaysPreserveAspectRatio:o}=this.options.resize;return({node:l,getPos:r,HTMLAttributes:s,editor:a})=>{const i=document.createElement("img");Object.entries(s).forEach(([u,f])=>{if(f!=null)switch(u){case"width":case"height":break;default:i.setAttribute(u,f);break}}),i.src=s.src;const c=new Be({element:i,editor:a,node:l,getPos:r,onResize:(u,f)=>{i.style.width=`${u}px`,i.style.height=`${f}px`},onCommit:(u,f)=>{const h=r();h!==void 0&&this.editor.chain().setNodeSelection(h).updateAttributes(this.name,{width:u,height:f}).run()},onUpdate:(u,f,h)=>u.type===l.type,options:{directions:e,min:{width:t,height:n},preserveAspectRatio:o===!0}}),d=c.dom;return d.style.visibility="hidden",d.style.pointerEvents="none",i.onload=()=>{d.style.visibility="",d.style.pointerEvents=""},c}},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[Ie({find:Ct,type:this.type,getAttributes:e=>{const[,,t,n,o]=e;return{src:n,alt:t,title:o}}})]}}),At=xt;let ee,te;if(typeof WeakMap<"u"){let e=new WeakMap;ee=t=>e.get(t),te=(t,n)=>(e.set(t,n),n)}else{const e=[];let n=0;ee=o=>{for(let l=0;l<e.length;l+=2)if(e[l]==o)return e[l+1]},te=(o,l)=>(n==10&&(n=0),e[n++]=o,e[n++]=l)}var C=class{constructor(e,t,n,o){this.width=e,this.height=t,this.map=n,this.problems=o}findCell(e){for(let t=0;t<this.map.length;t++){const n=this.map[t];if(n!=e)continue;const o=t%this.width,l=t/this.width|0;let r=o+1,s=l+1;for(let a=1;r<this.width&&this.map[t+a]==n;a++)r++;for(let a=1;s<this.height&&this.map[t+this.width*a]==n;a++)s++;return{left:o,top:l,right:r,bottom:s}}throw new RangeError(`No cell with offset ${e} found`)}colCount(e){for(let t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError(`No cell with offset ${e} found`)}nextCell(e,t,n){const{left:o,right:l,top:r,bottom:s}=this.findCell(e);return t=="horiz"?(n<0?o==0:l==this.width)?null:this.map[r*this.width+(n<0?o-1:l)]:(n<0?r==0:s==this.height)?null:this.map[o+this.width*(n<0?r-1:s)]}rectBetween(e,t){const{left:n,right:o,top:l,bottom:r}=this.findCell(e),{left:s,right:a,top:i,bottom:c}=this.findCell(t);return{left:Math.min(n,s),top:Math.min(l,i),right:Math.max(o,a),bottom:Math.max(r,c)}}cellsInRect(e){const t=[],n={};for(let o=e.top;o<e.bottom;o++)for(let l=e.left;l<e.right;l++){const r=o*this.width+l,s=this.map[r];n[s]||(n[s]=!0,!(l==e.left&&l&&this.map[r-1]==s||o==e.top&&o&&this.map[r-this.width]==s)&&t.push(s))}return t}positionAt(e,t,n){for(let o=0,l=0;;o++){const r=l+n.child(o).nodeSize;if(o==e){let s=t+e*this.width;const a=(e+1)*this.width;for(;s<a&&this.map[s]<l;)s++;return s==a?r-1:this.map[s]}l=r}}static get(e){return ee(e)||te(e,vt(e))}};function vt(e){if(e.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+e.type.name);const t=kt(e),n=e.childCount,o=[];let l=0,r=null;const s=[];for(let c=0,d=t*n;c<d;c++)o[c]=0;for(let c=0,d=0;c<n;c++){const u=e.child(c);d++;for(let p=0;;p++){for(;l<o.length&&o[l]!=0;)l++;if(p==u.childCount)break;const m=u.child(p),{colspan:g,rowspan:w,colwidth:v}=m.attrs;for(let M=0;M<w;M++){if(M+c>=n){(r||(r=[])).push({type:"overlong_rowspan",pos:d,n:w-M});break}const N=l+M*t;for(let S=0;S<g;S++){o[N+S]==0?o[N+S]=d:(r||(r=[])).push({type:"collision",row:c,pos:d,n:g-S});const V=v&&v[S];if(V){const I=(N+S)%t*2,Y=s[I];Y==null||Y!=V&&s[I+1]==1?(s[I]=V,s[I+1]=1):Y==V&&s[I+1]++}}}l+=g,d+=m.nodeSize}const f=(c+1)*t;let h=0;for(;l<f;)o[l++]==0&&h++;h&&(r||(r=[])).push({type:"missing",row:c,n:h}),d++}(t===0||n===0)&&(r||(r=[])).push({type:"zero_sized"});const a=new C(t,n,o,r);let i=!1;for(let c=0;!i&&c<s.length;c+=2)s[c]!=null&&s[c+1]<n&&(i=!0);return i&&Mt(a,s,e),a}function kt(e){let t=-1,n=!1;for(let o=0;o<e.childCount;o++){const l=e.child(o);let r=0;if(n)for(let s=0;s<o;s++){const a=e.child(s);for(let i=0;i<a.childCount;i++){const c=a.child(i);s+c.attrs.rowspan>o&&(r+=c.attrs.colspan)}}for(let s=0;s<l.childCount;s++){const a=l.child(s);r+=a.attrs.colspan,a.attrs.rowspan>1&&(n=!0)}t==-1?t=r:t!=r&&(t=Math.max(t,r))}return t}function Mt(e,t,n){e.problems||(e.problems=[]);const o={};for(let l=0;l<e.map.length;l++){const r=e.map[l];if(o[r])continue;o[r]=!0;const s=n.nodeAt(r);if(!s)throw new RangeError(`No cell with offset ${r} found`);let a=null;const i=s.attrs;for(let c=0;c<i.colspan;c++){const d=t[(l+c)%e.width*2];d!=null&&(!i.colwidth||i.colwidth[c]!=d)&&((a||(a=St(i)))[c]=d)}a&&e.problems.unshift({type:"colwidth mismatch",pos:r,colwidth:a})}}function St(e){if(e.colwidth)return e.colwidth.slice();const t=[];for(let n=0;n<e.colspan;n++)t.push(0);return t}function x(e){let t=e.cached.tableNodeTypes;if(!t){t=e.cached.tableNodeTypes={};for(const n in e.nodes){const o=e.nodes[n],l=o.spec.tableRole;l&&(t[l]=o)}}return t}const j=new se("selectingCells");function D(e){for(let t=e.depth-1;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return e.node(0).resolve(e.before(t+1));return null}function Tt(e){for(let t=e.depth;t>0;t--){const n=e.node(t).type.spec.tableRole;if(n==="cell"||n==="header_cell")return e.node(t)}return null}function T(e){const t=e.selection.$head;for(let n=t.depth;n>0;n--)if(t.node(n).type.spec.tableRole=="row")return!0;return!1}function J(e){const t=e.selection;if("$anchorCell"in t&&t.$anchorCell)return t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell;if("node"in t&&t.node&&t.node.type.spec.tableRole=="cell")return t.$anchor;const n=D(t.$head)||Rt(t.$head);if(n)return n;throw new RangeError(`No cell found around position ${t.head}`)}function Rt(e){for(let t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){const o=t.type.spec.tableRole;if(o=="cell"||o=="header_cell")return e.doc.resolve(n)}for(let t=e.nodeBefore,n=e.pos;t;t=t.lastChild,n--){const o=t.type.spec.tableRole;if(o=="cell"||o=="header_cell")return e.doc.resolve(n-t.nodeSize)}}function ne(e){return e.parent.type.spec.tableRole=="row"&&!!e.nodeAfter}function zt(e){return e.node(0).resolve(e.pos+e.nodeAfter.nodeSize)}function ae(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function Me(e,t,n){const o=e.node(-1),l=C.get(o),r=e.start(-1),s=l.nextCell(e.pos-r,t,n);return s==null?null:e.node(0).resolve(r+s)}function _(e,t,n=1){const o={...e,colspan:e.colspan-n};return o.colwidth&&(o.colwidth=o.colwidth.slice(),o.colwidth.splice(t,n),o.colwidth.some(l=>l>0)||(o.colwidth=null)),o}function Se(e,t,n=1){const o={...e,colspan:e.colspan+n};if(o.colwidth){o.colwidth=o.colwidth.slice();for(let l=0;l<n;l++)o.colwidth.splice(t,0,0)}return o}function Ht(e,t,n){const o=x(t.type.schema).header_cell;for(let l=0;l<e.height;l++)if(t.nodeAt(e.map[n+l*e.width]).type!=o)return!1;return!0}var b=class H extends L{constructor(t,n=t){const o=t.node(-1),l=C.get(o),r=t.start(-1),s=l.rectBetween(t.pos-r,n.pos-r),a=t.node(0),i=l.cellsInRect(s).filter(d=>d!=n.pos-r);i.unshift(n.pos-r);const c=i.map(d=>{const u=o.nodeAt(d);if(!u)throw new RangeError(`No cell with offset ${d} found`);const f=r+d+1;return new Ve(a.resolve(f),a.resolve(f+u.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=t,this.$headCell=n}map(t,n){const o=t.resolve(n.map(this.$anchorCell.pos)),l=t.resolve(n.map(this.$headCell.pos));if(ne(o)&&ne(l)&&ae(o,l)){const r=this.$anchorCell.node(-1)!=o.node(-1);return r&&this.isRowSelection()?H.rowSelection(o,l):r&&this.isColSelection()?H.colSelection(o,l):new H(o,l)}return E.between(o,l)}content(){const t=this.$anchorCell.node(-1),n=C.get(t),o=this.$anchorCell.start(-1),l=n.rectBetween(this.$anchorCell.pos-o,this.$headCell.pos-o),r={},s=[];for(let i=l.top;i<l.bottom;i++){const c=[];for(let d=i*n.width+l.left,u=l.left;u<l.right;u++,d++){const f=n.map[d];if(r[f])continue;r[f]=!0;const h=n.findCell(f);let p=t.nodeAt(f);if(!p)throw new RangeError(`No cell with offset ${f} found`);const m=l.left-h.left,g=h.right-l.right;if(m>0||g>0){let w=p.attrs;if(m>0&&(w=_(w,0,m)),g>0&&(w=_(w,w.colspan-g,g)),h.left<l.left){if(p=p.type.createAndFill(w),!p)throw new RangeError(`Could not create cell with attrs ${JSON.stringify(w)}`)}else p=p.type.create(w,p.content)}if(h.top<l.top||h.bottom>l.bottom){const w={...p.attrs,rowspan:Math.min(h.bottom,l.bottom)-Math.max(h.top,l.top)};h.top<l.top?p=p.type.createAndFill(w):p=p.type.create(w,p.content)}c.push(p)}s.push(t.child(i).copy(R.from(c)))}const a=this.isColSelection()&&this.isRowSelection()?t:s;return new $(R.from(a),1,1)}replace(t,n=$.empty){const o=t.steps.length,l=this.ranges;for(let s=0;s<l.length;s++){const{$from:a,$to:i}=l[s],c=t.mapping.slice(o);t.replace(c.map(a.pos),c.map(i.pos),s?$.empty:n)}const r=L.findFrom(t.doc.resolve(t.mapping.slice(o).map(this.to)),-1);r&&t.setSelection(r)}replaceWith(t,n){this.replace(t,new $(R.from(n),0,0))}forEachCell(t){const n=this.$anchorCell.node(-1),o=C.get(n),l=this.$anchorCell.start(-1),r=o.cellsInRect(o.rectBetween(this.$anchorCell.pos-l,this.$headCell.pos-l));for(let s=0;s<r.length;s++)t(n.nodeAt(r[s]),l+r[s])}isColSelection(){const t=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(t,n)>0)return!1;const o=t+this.$anchorCell.nodeAfter.attrs.rowspan,l=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(o,l)==this.$headCell.node(-1).childCount}static colSelection(t,n=t){const o=t.node(-1),l=C.get(o),r=t.start(-1),s=l.findCell(t.pos-r),a=l.findCell(n.pos-r),i=t.node(0);return s.top<=a.top?(s.top>0&&(t=i.resolve(r+l.map[s.left])),a.bottom<l.height&&(n=i.resolve(r+l.map[l.width*(l.height-1)+a.right-1]))):(a.top>0&&(n=i.resolve(r+l.map[a.left])),s.bottom<l.height&&(t=i.resolve(r+l.map[l.width*(l.height-1)+s.right-1]))),new H(t,n)}isRowSelection(){const t=this.$anchorCell.node(-1),n=C.get(t),o=this.$anchorCell.start(-1),l=n.colCount(this.$anchorCell.pos-o),r=n.colCount(this.$headCell.pos-o);if(Math.min(l,r)>0)return!1;const s=l+this.$anchorCell.nodeAfter.attrs.colspan,a=r+this.$headCell.nodeAfter.attrs.colspan;return Math.max(s,a)==n.width}eq(t){return t instanceof H&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos}static rowSelection(t,n=t){const o=t.node(-1),l=C.get(o),r=t.start(-1),s=l.findCell(t.pos-r),a=l.findCell(n.pos-r),i=t.node(0);return s.left<=a.left?(s.left>0&&(t=i.resolve(r+l.map[s.top*l.width])),a.right<l.width&&(n=i.resolve(r+l.map[l.width*(a.top+1)-1]))):(a.left>0&&(n=i.resolve(r+l.map[a.top*l.width])),s.right<l.width&&(t=i.resolve(r+l.map[l.width*(s.top+1)-1]))),new H(t,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(t,n){return new H(t.resolve(n.anchor),t.resolve(n.head))}static create(t,n,o=n){return new H(t.resolve(n),t.resolve(o))}getBookmark(){return new Lt(this.$anchorCell.pos,this.$headCell.pos)}};b.prototype.visible=!1;L.jsonID("cell",b);var Lt=class Te{constructor(t,n){this.anchor=t,this.head=n}map(t){return new Te(t.map(this.anchor),t.map(this.head))}resolve(t){const n=t.resolve(this.anchor),o=t.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&o.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&o.index()<o.parent.childCount&&ae(n,o)?new b(n,o):L.near(o,1)}};function Nt(e){if(!(e.selection instanceof b))return null;const t=[];return e.selection.forEachCell((n,o)=>{t.push(Z.node(o,o+n.nodeSize,{class:"selectedCell"}))}),Q.create(e.doc,t)}function jt({$from:e,$to:t}){if(e.pos==t.pos||e.pos<t.pos-6)return!1;let n=e.pos,o=t.pos,l=e.depth;for(;l>=0&&!(e.after(l+1)<e.end(l));l--,n++);for(let r=t.depth;r>=0&&!(t.before(r+1)>t.start(r));r--,o--);return n==o&&/row|table/.test(e.node(l).type.spec.tableRole)}function Et({$from:e,$to:t}){let n,o;for(let l=e.depth;l>0;l--){const r=e.node(l);if(r.type.spec.tableRole==="cell"||r.type.spec.tableRole==="header_cell"){n=r;break}}for(let l=t.depth;l>0;l--){const r=t.node(l);if(r.type.spec.tableRole==="cell"||r.type.spec.tableRole==="header_cell"){o=r;break}}return n!==o&&t.parentOffset===0}function $t(e,t,n){const o=(t||e).selection,l=(t||e).doc;let r,s;if(o instanceof Pe&&(s=o.node.type.spec.tableRole)){if(s=="cell"||s=="header_cell")r=b.create(l,o.from);else if(s=="row"){const a=l.resolve(o.from+1);r=b.rowSelection(a,a)}else if(!n){const a=C.get(o.node),i=o.from+1,c=i+a.map[a.width*a.height-1];r=b.create(l,i+1,c)}}else o instanceof E&&jt(o)?r=E.create(l,o.from):o instanceof E&&Et(o)&&(r=E.create(l,o.$from.start(),o.$from.end()));return r&&(t||(t=e.tr)).setSelection(r),t}const Wt=new se("fix-tables");function Re(e,t,n,o){const l=e.childCount,r=t.childCount;e:for(let s=0,a=0;s<r;s++){const i=t.child(s);for(let c=a,d=Math.min(l,s+3);c<d;c++)if(e.child(c)==i){a=c+1,n+=i.nodeSize;continue e}o(i,n),a<l&&e.child(a).sameMarkup(i)?Re(e.child(a),i,n+1,o):i.nodesBetween(0,i.content.size,o,n+1),n+=i.nodeSize}}function ze(e,t){let n;const o=(l,r)=>{l.type.spec.tableRole=="table"&&(n=_t(e,l,r,n))};return t?t.doc!=e.doc&&Re(t.doc,e.doc,0,o):e.doc.descendants(o),n}function _t(e,t,n,o){const l=C.get(t);if(!l.problems)return o;o||(o=e.tr);const r=[];for(let i=0;i<l.height;i++)r.push(0);for(let i=0;i<l.problems.length;i++){const c=l.problems[i];if(c.type=="collision"){const d=t.nodeAt(c.pos);if(!d)continue;const u=d.attrs;for(let f=0;f<u.rowspan;f++)r[c.row+f]+=c.n;o.setNodeMarkup(o.mapping.map(n+1+c.pos),null,_(u,u.colspan-c.n,c.n))}else if(c.type=="missing")r[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const d=t.nodeAt(c.pos);if(!d)continue;o.setNodeMarkup(o.mapping.map(n+1+c.pos),null,{...d.attrs,rowspan:d.attrs.rowspan-c.n})}else if(c.type=="colwidth mismatch"){const d=t.nodeAt(c.pos);if(!d)continue;o.setNodeMarkup(o.mapping.map(n+1+c.pos),null,{...d.attrs,colwidth:c.colwidth})}else if(c.type=="zero_sized"){const d=o.mapping.map(n);o.delete(d,d+t.nodeSize)}}let s,a;for(let i=0;i<r.length;i++)r[i]&&(s==null&&(s=i),a=i);for(let i=0,c=n+1;i<l.height;i++){const d=t.child(i),u=c+d.nodeSize,f=r[i];if(f>0){let h="cell";d.firstChild&&(h=d.firstChild.type.spec.tableRole);const p=[];for(let g=0;g<f;g++){const w=x(e.schema)[h].createAndFill();w&&p.push(w)}const m=(i==0||s==i-1)&&a==i?c+1:u-1;o.insert(o.mapping.map(m),p)}c=u}return o.setMeta(Wt,{fixTables:!0})}function z(e){const t=e.selection,n=J(e),o=n.node(-1),l=n.start(-1),r=C.get(o);return{...t instanceof b?r.rectBetween(t.$anchorCell.pos-l,t.$headCell.pos-l):r.findCell(n.pos-l),tableStart:l,map:r,table:o}}function He(e,{map:t,tableStart:n,table:o},l){let r=l>0?-1:0;Ht(t,o,l+r)&&(r=l==0||l==t.width?null:0);for(let s=0;s<t.height;s++){const a=s*t.width+l;if(l>0&&l<t.width&&t.map[a-1]==t.map[a]){const i=t.map[a],c=o.nodeAt(i);e.setNodeMarkup(e.mapping.map(n+i),null,Se(c.attrs,l-t.colCount(i))),s+=c.attrs.rowspan-1}else{const i=r==null?x(o.type.schema).cell:o.nodeAt(t.map[a+r]).type,c=t.positionAt(s,l,o);e.insert(e.mapping.map(n+c),i.createAndFill())}}return e}function Dt(e,t){if(!T(e))return!1;if(t){const n=z(e);t(He(e.tr,n,n.left))}return!0}function It(e,t){if(!T(e))return!1;if(t){const n=z(e);t(He(e.tr,n,n.right))}return!0}function Bt(e,{map:t,table:n,tableStart:o},l){const r=e.mapping.maps.length;for(let s=0;s<t.height;){const a=s*t.width+l,i=t.map[a],c=n.nodeAt(i),d=c.attrs;if(l>0&&t.map[a-1]==i||l<t.width-1&&t.map[a+1]==i)e.setNodeMarkup(e.mapping.slice(r).map(o+i),null,_(d,l-t.colCount(i)));else{const u=e.mapping.slice(r).map(o+i);e.delete(u,u+c.nodeSize)}s+=d.rowspan}}function Ot(e,t){if(!T(e))return!1;if(t){const n=z(e),o=e.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let l=n.right-1;Bt(o,n,l),l!=n.left;l--){const r=n.tableStart?o.doc.nodeAt(n.tableStart-1):o.doc;if(!r)throw new RangeError("No table found");n.table=r,n.map=C.get(r)}t(o)}return!0}function Vt(e,t,n){var o;const l=x(t.type.schema).header_cell;for(let r=0;r<e.width;r++)if(((o=t.nodeAt(e.map[r+n*e.width]))===null||o===void 0?void 0:o.type)!=l)return!1;return!0}function Le(e,{map:t,tableStart:n,table:o},l){let r=n;for(let c=0;c<l;c++)r+=o.child(c).nodeSize;const s=[];let a=l>0?-1:0;Vt(t,o,l+a)&&(a=l==0||l==t.height?null:0);for(let c=0,d=t.width*l;c<t.width;c++,d++)if(l>0&&l<t.height&&t.map[d]==t.map[d-t.width]){const u=t.map[d],f=o.nodeAt(u).attrs;e.setNodeMarkup(n+u,null,{...f,rowspan:f.rowspan+1}),c+=f.colspan-1}else{var i;const u=a==null?x(o.type.schema).cell:(i=o.nodeAt(t.map[d+a*t.width]))===null||i===void 0?void 0:i.type,f=u==null?void 0:u.createAndFill();f&&s.push(f)}return e.insert(r,x(o.type.schema).row.create(null,s)),e}function Pt(e,t){if(!T(e))return!1;if(t){const n=z(e);t(Le(e.tr,n,n.top))}return!0}function Ft(e,t){if(!T(e))return!1;if(t){const n=z(e);t(Le(e.tr,n,n.bottom))}return!0}function qt(e,{map:t,table:n,tableStart:o},l){let r=0;for(let c=0;c<l;c++)r+=n.child(c).nodeSize;const s=r+n.child(l).nodeSize,a=e.mapping.maps.length;e.delete(r+o,s+o);const i=new Set;for(let c=0,d=l*t.width;c<t.width;c++,d++){const u=t.map[d];if(!i.has(u)){if(i.add(u),l>0&&u==t.map[d-t.width]){const f=n.nodeAt(u).attrs;e.setNodeMarkup(e.mapping.slice(a).map(u+o),null,{...f,rowspan:f.rowspan-1}),c+=f.colspan-1}else if(l<t.height&&u==t.map[d+t.width]){const f=n.nodeAt(u),h=f.attrs,p=f.type.create({...h,rowspan:f.attrs.rowspan-1},f.content),m=t.positionAt(l+1,c,n);e.insert(e.mapping.slice(a).map(o+m),p),c+=h.colspan-1}}}}function Kt(e,t){if(!T(e))return!1;if(t){const n=z(e),o=e.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let l=n.bottom-1;qt(o,n,l),l!=n.top;l--){const r=n.tableStart?o.doc.nodeAt(n.tableStart-1):o.doc;if(!r)throw new RangeError("No table found");n.table=r,n.map=C.get(n.table)}t(o)}return!0}function ce(e){const t=e.content;return t.childCount==1&&t.child(0).isTextblock&&t.child(0).childCount==0}function Ut({width:e,height:t,map:n},o){let l=o.top*e+o.left,r=l,s=(o.bottom-1)*e+o.left,a=l+(o.right-o.left-1);for(let i=o.top;i<o.bottom;i++){if(o.left>0&&n[r]==n[r-1]||o.right<e&&n[a]==n[a+1])return!0;r+=e,a+=e}for(let i=o.left;i<o.right;i++){if(o.top>0&&n[l]==n[l-e]||o.bottom<t&&n[s]==n[s+e])return!0;l++,s++}return!1}function de(e,t){const n=e.selection;if(!(n instanceof b)||n.$anchorCell.pos==n.$headCell.pos)return!1;const o=z(e),{map:l}=o;if(Ut(l,o))return!1;if(t){const r=e.tr,s={};let a=R.empty,i,c;for(let d=o.top;d<o.bottom;d++)for(let u=o.left;u<o.right;u++){const f=l.map[d*l.width+u],h=o.table.nodeAt(f);if(!(s[f]||!h))if(s[f]=!0,i==null)i=f,c=h;else{ce(h)||(a=a.append(h.content));const p=r.mapping.map(f+o.tableStart);r.delete(p,p+h.nodeSize)}}if(i==null||c==null)return!0;if(r.setNodeMarkup(i+o.tableStart,null,{...Se(c.attrs,c.attrs.colspan,o.right-o.left-c.attrs.colspan),rowspan:o.bottom-o.top}),a.size>0){const d=i+1+c.content.size,u=ce(c)?i+1:d;r.replaceWith(u+o.tableStart,d+o.tableStart,a)}r.setSelection(new b(r.doc.resolve(i+o.tableStart))),t(r)}return!0}function ue(e,t){const n=x(e.schema);return Xt(({node:o})=>n[o.type.spec.tableRole])(e,t)}function Xt(e){return(t,n)=>{const o=t.selection;let l,r;if(o instanceof b){if(o.$anchorCell.pos!=o.$headCell.pos)return!1;l=o.$anchorCell.nodeAfter,r=o.$anchorCell.pos}else{var s;if(l=Tt(o.$from),!l)return!1;r=(s=D(o.$from))===null||s===void 0?void 0:s.pos}if(l==null||r==null||l.attrs.colspan==1&&l.attrs.rowspan==1)return!1;if(n){let a=l.attrs;const i=[],c=a.colwidth;a.rowspan>1&&(a={...a,rowspan:1}),a.colspan>1&&(a={...a,colspan:1});const d=z(t),u=t.tr;for(let h=0;h<d.right-d.left;h++)i.push(c?{...a,colwidth:c&&c[h]?[c[h]]:null}:a);let f;for(let h=d.top;h<d.bottom;h++){let p=d.map.positionAt(h,d.left,d.table);h==d.top&&(p+=l.nodeSize);for(let m=d.left,g=0;m<d.right;m++,g++)m==d.left&&h==d.top||u.insert(f=u.mapping.map(p+d.tableStart,1),e({node:l,row:h,col:m}).createAndFill(i[g]))}u.setNodeMarkup(r,e({node:l,row:d.top,col:d.left}),i[0]),o instanceof b&&u.setSelection(new b(u.doc.resolve(o.$anchorCell.pos),f?u.doc.resolve(f):void 0)),n(u)}return!0}}function Jt(e,t){return function(n,o){if(!T(n))return!1;const l=J(n);if(l.nodeAfter.attrs[e]===t)return!1;if(o){const r=n.tr;n.selection instanceof b?n.selection.forEachCell((s,a)=>{s.attrs[e]!==t&&r.setNodeMarkup(a,null,{...s.attrs,[e]:t})}):r.setNodeMarkup(l.pos,null,{...l.nodeAfter.attrs,[e]:t}),o(r)}return!0}}function Yt(e){return function(t,n){if(!T(t))return!1;if(n){const o=x(t.schema),l=z(t),r=t.tr,s=l.map.cellsInRect(e=="column"?{left:l.left,top:0,right:l.right,bottom:l.map.height}:e=="row"?{left:0,top:l.top,right:l.map.width,bottom:l.bottom}:l),a=s.map(i=>l.table.nodeAt(i));for(let i=0;i<s.length;i++)a[i].type==o.header_cell&&r.setNodeMarkup(l.tableStart+s[i],o.cell,a[i].attrs);if(r.steps.length===0)for(let i=0;i<s.length;i++)r.setNodeMarkup(l.tableStart+s[i],o.header_cell,a[i].attrs);n(r)}return!0}}function fe(e,t,n){const o=t.map.cellsInRect({left:0,top:0,right:e=="row"?t.map.width:1,bottom:e=="column"?t.map.height:1});for(let l=0;l<o.length;l++){const r=t.table.nodeAt(o[l]);if(r&&r.type!==n.header_cell)return!1}return!0}function B(e,t){return t=t||{useDeprecatedLogic:!1},t.useDeprecatedLogic?Yt(e):function(n,o){if(!T(n))return!1;if(o){const l=x(n.schema),r=z(n),s=n.tr,a=fe("row",r,l),i=fe("column",r,l),c=(e==="column"?a:e==="row"&&i)?1:0,d=e=="column"?{left:0,top:c,right:1,bottom:r.map.height}:e=="row"?{left:c,top:0,right:r.map.width,bottom:1}:r,u=e=="column"?i?l.cell:l.header_cell:e=="row"?a?l.cell:l.header_cell:l.cell;r.map.cellsInRect(d).forEach(f=>{const h=f+r.tableStart,p=s.doc.nodeAt(h);p&&s.setNodeMarkup(h,u,p.attrs)}),o(s)}return!0}}B("row",{useDeprecatedLogic:!0});B("column",{useDeprecatedLogic:!0});const Gt=B("cell",{useDeprecatedLogic:!0});function Qt(e,t){if(t<0){const n=e.nodeBefore;if(n)return e.pos-n.nodeSize;for(let o=e.index(-1)-1,l=e.before();o>=0;o--){const r=e.node(-1).child(o),s=r.lastChild;if(s)return l-1-s.nodeSize;l-=r.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;const n=e.node(-1);for(let o=e.indexAfter(-1),l=e.after();o<n.childCount;o++){const r=n.child(o);if(r.childCount)return l+1;l+=r.nodeSize}}return null}function he(e){return function(t,n){if(!T(t))return!1;const o=Qt(J(t),e);if(o==null)return!1;if(n){const l=t.doc.resolve(o);n(t.tr.setSelection(E.between(l,zt(l))).scrollIntoView())}return!0}}function Zt(e,t){const n=e.selection.$anchor;for(let o=n.depth;o>0;o--)if(n.node(o).type.spec.tableRole=="table")return t&&t(e.tr.delete(n.before(o),n.after(o)).scrollIntoView()),!0;return!1}function P(e,t){const n=e.selection;if(!(n instanceof b))return!1;if(t){const o=e.tr,l=x(e.schema).cell.createAndFill().content;n.forEachCell((r,s)=>{r.content.eq(l)||o.replace(o.mapping.map(s+1),o.mapping.map(s+r.nodeSize-1),new $(l,0,0))}),o.docChanged&&t(o)}return!0}function en(e){if(e.size===0)return null;let{content:t,openStart:n,openEnd:o}=e;for(;t.childCount==1&&(n>0&&o>0||t.child(0).type.spec.tableRole=="table");)n--,o--,t=t.child(0).content;const l=t.child(0),r=l.type.spec.tableRole,s=l.type.schema,a=[];if(r=="row")for(let i=0;i<t.childCount;i++){let c=t.child(i).content;const d=i?0:Math.max(0,n-1),u=i<t.childCount-1?0:Math.max(0,o-1);(d||u)&&(c=oe(x(s).row,new $(c,d,u)).content),a.push(c)}else if(r=="cell"||r=="header_cell")a.push(n||o?oe(x(s).row,new $(t,n,o)).content:t);else return null;return tn(s,a)}function tn(e,t){const n=[];for(let l=0;l<t.length;l++){const r=t[l];for(let s=r.childCount-1;s>=0;s--){const{rowspan:a,colspan:i}=r.child(s).attrs;for(let c=l;c<l+a;c++)n[c]=(n[c]||0)+i}}let o=0;for(let l=0;l<n.length;l++)o=Math.max(o,n[l]);for(let l=0;l<n.length;l++)if(l>=t.length&&t.push(R.empty),n[l]<o){const r=x(e).cell.createAndFill(),s=[];for(let a=n[l];a<o;a++)s.push(r);t[l]=t[l].append(R.from(s))}return{height:t.length,width:o,rows:t}}function oe(e,t){const n=e.createAndFill();return new Fe(n).replace(0,n.content.size,t).doc}function nn({width:e,height:t,rows:n},o,l){if(e!=o){const r=[],s=[];for(let a=0;a<n.length;a++){const i=n[a],c=[];for(let d=r[a]||0,u=0;d<o;u++){let f=i.child(u%i.childCount);d+f.attrs.colspan>o&&(f=f.type.createChecked(_(f.attrs,f.attrs.colspan,d+f.attrs.colspan-o),f.content)),c.push(f),d+=f.attrs.colspan;for(let h=1;h<f.attrs.rowspan;h++)r[a+h]=(r[a+h]||0)+f.attrs.colspan}s.push(R.from(c))}n=s,e=o}if(t!=l){const r=[];for(let s=0,a=0;s<l;s++,a++){const i=[],c=n[a%t];for(let d=0;d<c.childCount;d++){let u=c.child(d);s+u.attrs.rowspan>l&&(u=u.type.create({...u.attrs,rowspan:Math.max(1,l-u.attrs.rowspan)},u.content)),i.push(u)}r.push(R.from(i))}n=r,t=l}return{width:e,height:t,rows:n}}function on(e,t,n,o,l,r,s){const a=e.doc.type.schema,i=x(a);let c,d;if(l>t.width)for(let u=0,f=0;u<t.height;u++){const h=n.child(u);f+=h.nodeSize;const p=[];let m;h.lastChild==null||h.lastChild.type==i.cell?m=c||(c=i.cell.createAndFill()):m=d||(d=i.header_cell.createAndFill());for(let g=t.width;g<l;g++)p.push(m);e.insert(e.mapping.slice(s).map(f-1+o),p)}if(r>t.height){const u=[];for(let p=0,m=(t.height-1)*t.width;p<Math.max(t.width,l);p++){const g=p>=t.width?!1:n.nodeAt(t.map[m+p]).type==i.header_cell;u.push(g?d||(d=i.header_cell.createAndFill()):c||(c=i.cell.createAndFill()))}const f=i.row.create(null,R.from(u)),h=[];for(let p=t.height;p<r;p++)h.push(f);e.insert(e.mapping.slice(s).map(o+n.nodeSize-2),h)}return!!(c||d)}function pe(e,t,n,o,l,r,s,a){if(s==0||s==t.height)return!1;let i=!1;for(let c=l;c<r;c++){const d=s*t.width+c,u=t.map[d];if(t.map[d-t.width]==u){i=!0;const f=n.nodeAt(u),{top:h,left:p}=t.findCell(u);e.setNodeMarkup(e.mapping.slice(a).map(u+o),null,{...f.attrs,rowspan:s-h}),e.insert(e.mapping.slice(a).map(t.positionAt(s,p,n)),f.type.createAndFill({...f.attrs,rowspan:h+f.attrs.rowspan-s})),c+=f.attrs.colspan-1}}return i}function ge(e,t,n,o,l,r,s,a){if(s==0||s==t.width)return!1;let i=!1;for(let c=l;c<r;c++){const d=c*t.width+s,u=t.map[d];if(t.map[d-1]==u){i=!0;const f=n.nodeAt(u),h=t.colCount(u),p=e.mapping.slice(a).map(u+o);e.setNodeMarkup(p,null,_(f.attrs,s-h,f.attrs.colspan-(s-h))),e.insert(p+f.nodeSize,f.type.createAndFill(_(f.attrs,0,s-h))),c+=f.attrs.rowspan-1}}return i}function me(e,t,n,o,l){let r=n?e.doc.nodeAt(n-1):e.doc;if(!r)throw new Error("No table found");let s=C.get(r);const{top:a,left:i}=o,c=i+l.width,d=a+l.height,u=e.tr;let f=0;function h(){if(r=n?u.doc.nodeAt(n-1):u.doc,!r)throw new Error("No table found");s=C.get(r),f=u.mapping.maps.length}on(u,s,r,n,c,d,f)&&h(),pe(u,s,r,n,i,c,a,f)&&h(),pe(u,s,r,n,i,c,d,f)&&h(),ge(u,s,r,n,a,d,i,f)&&h(),ge(u,s,r,n,a,d,c,f)&&h();for(let p=a;p<d;p++){const m=s.positionAt(p,i,r),g=s.positionAt(p,c,r);u.replace(u.mapping.slice(f).map(m+n),u.mapping.slice(f).map(g+n),new $(l.rows[p-a],0,0))}h(),u.setSelection(new b(u.doc.resolve(n+s.positionAt(a,i,r)),u.doc.resolve(n+s.positionAt(d-1,c-1,r)))),t(u)}const ln=Oe({ArrowLeft:F("horiz",-1),ArrowRight:F("horiz",1),ArrowUp:F("vert",-1),ArrowDown:F("vert",1),"Shift-ArrowLeft":q("horiz",-1),"Shift-ArrowRight":q("horiz",1),"Shift-ArrowUp":q("vert",-1),"Shift-ArrowDown":q("vert",1),Backspace:P,"Mod-Backspace":P,Delete:P,"Mod-Delete":P});function U(e,t,n){return n.eq(e.selection)?!1:(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function F(e,t){return(n,o,l)=>{if(!l)return!1;const r=n.selection;if(r instanceof b)return U(n,o,L.near(r.$headCell,t));if(e!="horiz"&&!r.empty)return!1;const s=Ne(l,e,t);if(s==null)return!1;if(e=="horiz")return U(n,o,L.near(n.doc.resolve(r.head+t),t));{const a=n.doc.resolve(s),i=Me(a,e,t);let c;return i?c=L.near(i,1):t<0?c=L.near(n.doc.resolve(a.before(-1)),-1):c=L.near(n.doc.resolve(a.after(-1)),1),U(n,o,c)}}}function q(e,t){return(n,o,l)=>{if(!l)return!1;const r=n.selection;let s;if(r instanceof b)s=r;else{const i=Ne(l,e,t);if(i==null)return!1;s=new b(n.doc.resolve(i))}const a=Me(s.$headCell,e,t);return a?U(n,o,new b(s.$anchorCell,a)):!1}}function rn(e,t){const n=e.state.doc,o=D(n.resolve(t));return o?(e.dispatch(e.state.tr.setSelection(new b(o))),!0):!1}function sn(e,t,n){if(!T(e.state))return!1;let o=en(n);const l=e.state.selection;if(l instanceof b){o||(o={width:1,height:1,rows:[R.from(oe(x(e.state.schema).cell,n))]});const r=l.$anchorCell.node(-1),s=l.$anchorCell.start(-1),a=C.get(r).rectBetween(l.$anchorCell.pos-s,l.$headCell.pos-s);return o=nn(o,a.right-a.left,a.bottom-a.top),me(e.state,e.dispatch,s,a,o),!0}else if(o){const r=J(e.state),s=r.start(-1);return me(e.state,e.dispatch,s,C.get(r.node(-1)).findCell(r.pos-s),o),!0}else return!1}function an(e,t){var n;if(t.ctrlKey||t.metaKey)return;const o=ye(e,t.target);let l;if(t.shiftKey&&e.state.selection instanceof b)r(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&o&&(l=D(e.state.selection.$anchor))!=null&&((n=G(e,t))===null||n===void 0?void 0:n.pos)!=l.pos)r(l,t),t.preventDefault();else if(!o)return;function r(i,c){let d=G(e,c);const u=j.getState(e.state)==null;if(!d||!ae(i,d))if(u)d=i;else return;const f=new b(i,d);if(u||!e.state.selection.eq(f)){const h=e.state.tr.setSelection(f);u&&h.setMeta(j,i.pos),e.dispatch(h)}}function s(){e.root.removeEventListener("mouseup",s),e.root.removeEventListener("dragstart",s),e.root.removeEventListener("mousemove",a),j.getState(e.state)!=null&&e.dispatch(e.state.tr.setMeta(j,-1))}function a(i){const c=i,d=j.getState(e.state);let u;if(d!=null)u=e.state.doc.resolve(d);else if(ye(e,c.target)!=o&&(u=G(e,t),!u))return s();u&&r(u,c)}e.root.addEventListener("mouseup",s),e.root.addEventListener("dragstart",s),e.root.addEventListener("mousemove",a)}function Ne(e,t,n){if(!(e.state.selection instanceof E))return null;const{$head:o}=e.state.selection;for(let l=o.depth-1;l>=0;l--){const r=o.node(l);if((n<0?o.index(l):o.indexAfter(l))!=(n<0?0:r.childCount))return null;if(r.type.spec.tableRole=="cell"||r.type.spec.tableRole=="header_cell"){const s=o.before(l),a=t=="vert"?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(a)?s:null}}return null}function ye(e,t){for(;t&&t!=e.dom;t=t.parentNode)if(t.nodeName=="TD"||t.nodeName=="TH")return t;return null}function G(e,t){const n=e.posAtCoords({left:t.clientX,top:t.clientY});if(!n)return null;const o=n.inside>=0?n.inside:n.pos;return D(e.state.doc.resolve(o))}var cn=class{constructor(t,n){this.node=t,this.defaultCellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${n}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),le(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!=this.node.type?!1:(this.node=t,le(t,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(t){return t.type=="attributes"&&(t.target==this.table||this.colgroup.contains(t.target))}};function le(e,t,n,o,l,r){let s=0,a=!0,i=t.firstChild;const c=e.firstChild;if(c){for(let u=0,f=0;u<c.childCount;u++){const{colspan:h,colwidth:p}=c.child(u).attrs;for(let m=0;m<h;m++,f++){const g=l==f?r:p&&p[m],w=g?g+"px":"";if(s+=g||o,g||(a=!1),i)i.style.width!=w&&(i.style.width=w),i=i.nextSibling;else{const v=document.createElement("col");v.style.width=w,t.appendChild(v)}}}for(;i;){var d;const u=i.nextSibling;(d=i.parentNode)===null||d===void 0||d.removeChild(i),i=u}a?(n.style.width=s+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=s+"px")}}const k=new se("tableColumnResizing");function dn({handleWidth:e=5,cellMinWidth:t=25,defaultCellMinWidth:n=100,View:o=cn,lastColumnResizable:l=!0}={}){const r=new ve({key:k,state:{init(s,a){var i;const c=(i=r.spec)===null||i===void 0||(i=i.props)===null||i===void 0?void 0:i.nodeViews,d=x(a.schema).table.name;return o&&c&&(c[d]=(u,f)=>new o(u,n,f)),new un(-1,!1)},apply(s,a){return a.apply(s)}},props:{attributes:s=>{const a=k.getState(s);return a&&a.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(s,a)=>{fn(s,a,e,l)},mouseleave:s=>{hn(s)},mousedown:(s,a)=>{pn(s,a,t,n)}},decorations:s=>{const a=k.getState(s);if(a&&a.activeHandle>-1)return bn(s,a.activeHandle)},nodeViews:{}}});return r}var un=class X{constructor(t,n){this.activeHandle=t,this.dragging=n}apply(t){const n=this,o=t.getMeta(k);if(o&&o.setHandle!=null)return new X(o.setHandle,!1);if(o&&o.setDragging!==void 0)return new X(n.activeHandle,o.setDragging);if(n.activeHandle>-1&&t.docChanged){let l=t.mapping.map(n.activeHandle,-1);return ne(t.doc.resolve(l))||(l=-1),new X(l,n.dragging)}return n}};function fn(e,t,n,o){if(!e.editable)return;const l=k.getState(e.state);if(l&&!l.dragging){const r=mn(t.target);let s=-1;if(r){const{left:a,right:i}=r.getBoundingClientRect();t.clientX-a<=n?s=we(e,t,"left",n):i-t.clientX<=n&&(s=we(e,t,"right",n))}if(s!=l.activeHandle){if(!o&&s!==-1){const a=e.state.doc.resolve(s),i=a.node(-1),c=C.get(i),d=a.start(-1);if(c.colCount(a.pos-d)+a.nodeAfter.attrs.colspan-1==c.width-1)return}je(e,s)}}}function hn(e){if(!e.editable)return;const t=k.getState(e.state);t&&t.activeHandle>-1&&!t.dragging&&je(e,-1)}function pn(e,t,n,o){var l;if(!e.editable)return!1;const r=(l=e.dom.ownerDocument.defaultView)!==null&&l!==void 0?l:window,s=k.getState(e.state);if(!s||s.activeHandle==-1||s.dragging)return!1;const a=e.state.doc.nodeAt(s.activeHandle),i=gn(e,s.activeHandle,a.attrs);e.dispatch(e.state.tr.setMeta(k,{setDragging:{startX:t.clientX,startWidth:i}}));function c(u){r.removeEventListener("mouseup",c),r.removeEventListener("mousemove",d);const f=k.getState(e.state);f!=null&&f.dragging&&(yn(e,f.activeHandle,be(f.dragging,u,n)),e.dispatch(e.state.tr.setMeta(k,{setDragging:null})))}function d(u){if(!u.which)return c(u);const f=k.getState(e.state);if(f&&f.dragging){const h=be(f.dragging,u,n);Ce(e,f.activeHandle,h,o)}}return Ce(e,s.activeHandle,i,o),r.addEventListener("mouseup",c),r.addEventListener("mousemove",d),t.preventDefault(),!0}function gn(e,t,{colspan:n,colwidth:o}){const l=o&&o[o.length-1];if(l)return l;const r=e.domAtPos(t);let s=r.node.childNodes[r.offset].offsetWidth,a=n;if(o)for(let i=0;i<n;i++)o[i]&&(s-=o[i],a--);return s/a}function mn(e){for(;e&&e.nodeName!="TD"&&e.nodeName!="TH";)e=e.classList&&e.classList.contains("ProseMirror")?null:e.parentNode;return e}function we(e,t,n,o){const l=n=="right"?-o:o,r=e.posAtCoords({left:t.clientX+l,top:t.clientY});if(!r)return-1;const{pos:s}=r,a=D(e.state.doc.resolve(s));if(!a)return-1;if(n=="right")return a.pos;const i=C.get(a.node(-1)),c=a.start(-1),d=i.map.indexOf(a.pos-c);return d%i.width==0?-1:c+i.map[d-1]}function be(e,t,n){const o=t.clientX-e.startX;return Math.max(n,e.startWidth+o)}function je(e,t){e.dispatch(e.state.tr.setMeta(k,{setHandle:t}))}function yn(e,t,n){const o=e.state.doc.resolve(t),l=o.node(-1),r=C.get(l),s=o.start(-1),a=r.colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1,i=e.state.tr;for(let c=0;c<r.height;c++){const d=c*r.width+a;if(c&&r.map[d]==r.map[d-r.width])continue;const u=r.map[d],f=l.nodeAt(u).attrs,h=f.colspan==1?0:a-r.colCount(u);if(f.colwidth&&f.colwidth[h]==n)continue;const p=f.colwidth?f.colwidth.slice():wn(f.colspan);p[h]=n,i.setNodeMarkup(s+u,null,{...f,colwidth:p})}i.docChanged&&e.dispatch(i)}function Ce(e,t,n,o){const l=e.state.doc.resolve(t),r=l.node(-1),s=l.start(-1),a=C.get(r).colCount(l.pos-s)+l.nodeAfter.attrs.colspan-1;let i=e.domAtPos(l.start(-1)).node;for(;i&&i.nodeName!="TABLE";)i=i.parentNode;i&&le(r,i.firstChild,i,o,a,n)}function wn(e){return Array(e).fill(0)}function bn(e,t){const n=[],o=e.doc.resolve(t),l=o.node(-1);if(!l)return Q.empty;const r=C.get(l),s=o.start(-1),a=r.colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1;for(let c=0;c<r.height;c++){const d=a+c*r.width;if((a==r.width-1||r.map[d]!=r.map[d+1])&&(c==0||r.map[d]!=r.map[d-r.width])){var i;const u=r.map[d],f=s+u+l.nodeAt(u).nodeSize-1,h=document.createElement("div");h.className="column-resize-handle",!((i=k.getState(e))===null||i===void 0)&&i.dragging&&n.push(Z.node(s+u,s+u+l.nodeAt(u).nodeSize,{class:"column-resize-dragging"})),n.push(Z.widget(f,h))}}return Q.create(e.doc,n)}function Cn({allowTableNodeSelection:e=!1}={}){return new ve({key:j,state:{init(){return null},apply(t,n){const o=t.getMeta(j);if(o!=null)return o==-1?null:o;if(n==null||!t.docChanged)return n;const{deleted:l,pos:r}=t.mapping.mapResult(n);return l?null:r}},props:{decorations:Nt,handleDOMEvents:{mousedown:an},createSelectionBetween(t){return j.getState(t.state)!=null?t.state.selection:null},handleTripleClick:rn,handleKeyDown:ln,handlePaste:sn},appendTransaction(t,n,o){return $t(o,ze(o,n),e)}})}var Ee=O.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{var t,n;const o=e.getAttribute("colwidth"),l=o?o.split(",").map(r=>parseInt(r,10)):null;if(!l){const r=(t=e.closest("table"))==null?void 0:t.querySelectorAll("colgroup > col"),s=Array.from(((n=e.parentElement)==null?void 0:n.children)||[]).indexOf(e);if(s&&s>-1&&r&&r[s]){const a=r[s].getAttribute("width");return a?[parseInt(a,10)]:null}}return l}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:e}){return["td",W(this.options.HTMLAttributes,e),0]}}),$e=O.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(o=>parseInt(o,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:e}){return["th",W(this.options.HTMLAttributes,e),0]}}),We=O.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:e}){return["tr",W(this.options.HTMLAttributes,e),0]}});function re(e,t){return t?["width",`${Math.max(t,e)}px`]:["min-width",`${e}px`]}function xe(e,t,n,o,l,r){var s;let a=0,i=!0,c=t.firstChild;const d=e.firstChild;if(d!==null)for(let f=0,h=0;f<d.childCount;f+=1){const{colspan:p,colwidth:m}=d.child(f).attrs;for(let g=0;g<p;g+=1,h+=1){const w=l===h?r:m&&m[g],v=w?`${w}px`:"";if(a+=w||o,w||(i=!1),c){if(c.style.width!==v){const[M,N]=re(o,w);c.style.setProperty(M,N)}c=c.nextSibling}else{const M=document.createElement("col"),[N,S]=re(o,w);M.style.setProperty(N,S),t.appendChild(M)}}}for(;c;){const f=c.nextSibling;(s=c.parentNode)==null||s.removeChild(c),c=f}const u=e.attrs.style&&typeof e.attrs.style=="string"&&/\bwidth\s*:/i.test(e.attrs.style);i&&!u?(n.style.width=`${a}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${a}px`)}var xn=class{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),e.attrs.style&&(this.table.style.cssText=e.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),xe(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!==this.node.type?!1:(this.node=e,xe(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){const t=e.target,n=this.dom.contains(t),o=this.contentDOM.contains(t);return!!(n&&!o&&(e.type==="attributes"||e.type==="childList"||e.type==="characterData"))}};function An(e,t,n,o){let l=0,r=!0;const s=[],a=e.firstChild;if(!a)return{};for(let u=0,f=0;u<a.childCount;u+=1){const{colspan:h,colwidth:p}=a.child(u).attrs;for(let m=0;m<h;m+=1,f+=1){const g=n===f?o:p&&p[m];l+=g||t,g||(r=!1);const[w,v]=re(t,g);s.push(["col",{style:`${w}: ${v}`}])}}const i=r?`${l}px`:"",c=r?"":`${l}px`;return{colgroup:["colgroup",{},...s],tableWidth:i,tableMinWidth:c}}function Ae(e,t){return e.createAndFill()}function vn(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(n=>{const o=e.nodes[n];o.spec.tableRole&&(t[o.spec.tableRole]=o)}),e.cached.tableNodeTypes=t,t}function kn(e,t,n,o,l){const r=vn(e),s=[],a=[];for(let c=0;c<n;c+=1){const d=Ae(r.cell);if(d&&a.push(d),o){const u=Ae(r.header_cell);u&&s.push(u)}}const i=[];for(let c=0;c<t;c+=1)i.push(r.row.createChecked(null,o&&c===0?s:a));return r.table.createChecked(null,i)}function Mn(e){return e instanceof b}var K=({editor:e})=>{const{selection:t}=e.state;if(!Mn(t))return!1;let n=0;const o=Ue(t.ranges[0].$from,r=>r.type.name==="table");return o==null||o.node.descendants(r=>{if(r.type.name==="table")return!1;["tableCell","tableHeader"].includes(r.type.name)&&(n+=1)}),n===t.ranges.length?(e.commands.deleteTable(),!0):!1},Sn="";function Tn(e){return(e||"").replace(/\s+/g," ").trim()}function Rn(e,t,n={}){var o;const l=(o=n.cellLineSeparator)!=null?o:Sn;if(!e||!e.content||e.content.length===0)return"";const r=[];e.content.forEach(p=>{const m=[];p.content&&p.content.forEach(g=>{let w="";g.content&&Array.isArray(g.content)&&g.content.length>1?w=g.content.map(S=>t.renderChildren(S)).join(l):w=g.content?t.renderChildren(g.content):"";const v=Tn(w),M=g.type==="tableHeader";m.push({text:v,isHeader:M})}),r.push(m)});const s=r.reduce((p,m)=>Math.max(p,m.length),0);if(s===0)return"";const a=new Array(s).fill(0);r.forEach(p=>{var m;for(let g=0;g<s;g+=1){const v=(((m=p[g])==null?void 0:m.text)||"").length;v>a[g]&&(a[g]=v),a[g]<3&&(a[g]=3)}});const i=(p,m)=>p+" ".repeat(Math.max(0,m-p.length)),c=r[0],d=c.some(p=>p.isHeader);let u=`
`;const f=new Array(s).fill(0).map((p,m)=>d&&c[m]&&c[m].text||"");return u+=`| ${f.map((p,m)=>i(p,a[m])).join(" | ")} |
`,u+=`| ${a.map(p=>"-".repeat(Math.max(3,p))).join(" | ")} |
`,(d?r.slice(1):r).forEach(p=>{u+=`| ${new Array(s).fill(0).map((m,g)=>i(p[g]&&p[g].text||"",a[g])).join(" | ")} |
`}),u}var zn=Rn,_e=O.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:xn,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:e,HTMLAttributes:t}){const{colgroup:n,tableWidth:o,tableMinWidth:l}=An(e,this.options.cellMinWidth),r=t.style;function s(){return r||(o?`width: ${o}`:`min-width: ${l}`)}const a=["table",W(this.options.HTMLAttributes,t,{style:s()}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},a]:a},parseMarkdown:(e,t)=>{const n=[];if(e.header){const o=[];e.header.forEach(l=>{o.push(t.createNode("tableHeader",{},[{type:"paragraph",content:t.parseInline(l.tokens)}]))}),n.push(t.createNode("tableRow",{},o))}return e.rows&&e.rows.forEach(o=>{const l=[];o.forEach(r=>{l.push(t.createNode("tableCell",{},[{type:"paragraph",content:t.parseInline(r.tokens)}]))}),n.push(t.createNode("tableRow",{},l))}),t.createNode("table",void 0,n)},renderMarkdown:(e,t)=>zn(e,t),addCommands(){return{insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:o,dispatch:l,editor:r})=>{const s=kn(r.schema,e,t,n);if(l){const a=o.selection.from+1;o.replaceSelectionWith(s).scrollIntoView().setSelection(E.near(o.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>Dt(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>It(e,t),deleteColumn:()=>({state:e,dispatch:t})=>Ot(e,t),addRowBefore:()=>({state:e,dispatch:t})=>Pt(e,t),addRowAfter:()=>({state:e,dispatch:t})=>Ft(e,t),deleteRow:()=>({state:e,dispatch:t})=>Kt(e,t),deleteTable:()=>({state:e,dispatch:t})=>Zt(e,t),mergeCells:()=>({state:e,dispatch:t})=>de(e,t),splitCell:()=>({state:e,dispatch:t})=>ue(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>B("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>B("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>Gt(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>de(e,t)?!0:ue(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:o})=>Jt(e,t)(n,o),goToNextCell:()=>({state:e,dispatch:t})=>he(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>he(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&ze(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){const o=b.create(t.doc,e.anchorCell,e.headCell);t.setSelection(o)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:K,"Mod-Backspace":K,Delete:K,"Mod-Delete":K}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[dn({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],Cn({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){const t={name:e.name,options:e.options,storage:e.storage};return{tableRole:qe(Ke(e,"tableRole",t))}}});ke.create({name:"tableKit",addExtensions(){const e=[];return this.options.table!==!1&&e.push(_e.configure(this.options.table)),this.options.tableCell!==!1&&e.push(Ee.configure(this.options.tableCell)),this.options.tableHeader!==!1&&e.push($e.configure(this.options.tableHeader)),this.options.tableRow!==!1&&e.push(We.configure(this.options.tableRow)),e}});var Hn=We,Ln=Ee,Nn=$e,jn=Xe,En=Je,$n=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,Wn=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,_n=ie.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:e=>e.getAttribute("data-color")||e.style.backgroundColor,renderHTML:e=>e.color?{"data-color":e.color,style:`background-color: ${e.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:e}){return["mark",W(this.options.HTMLAttributes,e),0]},renderMarkdown:(e,t)=>`==${t.renderChildren(e)}==`,parseMarkdown:(e,t)=>t.applyMark("highlight",t.parseInline(e.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:e=>e.indexOf("=="),tokenize(e,t,n){const l=/^(==)([^=]+)(==)/.exec(e);if(l){const r=l[2].trim(),s=n.inlineTokens(r);return{type:"highlight",raw:l[0],text:r,tokens:s}}}},addCommands(){return{setHighlight:e=>({commands:t})=>t.setMark(this.name,e),toggleHighlight:e=>({commands:t})=>t.toggleMark(this.name,e),unsetHighlight:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Ge({find:$n,type:this.type})]},addPasteRules(){return[Ye({find:Wn,type:this.type})]}}),Dn=_n,In=ke.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>{const t=e.style.textAlign;return this.options.alignments.includes(t)?t:this.options.defaultAlignment},renderHTML:e=>e.textAlign?{style:`text-align: ${e.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.map(n=>t.updateAttributes(n,{textAlign:e})).some(n=>n):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.map(t=>e.resetAttributes(t,"textAlign")).some(t=>t),toggleTextAlign:e=>({editor:t,commands:n})=>this.options.alignments.includes(e)?t.isActive({textAlign:e})?n.unsetTextAlign():n.setTextAlign(e):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),Bn=In,On=ie.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(e){return e!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sub",W(this.options.HTMLAttributes,e),0]},addCommands(){return{setSubscript:()=>({commands:e})=>e.setMark(this.name),toggleSubscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSubscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),Vn=On,Pn=ie.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(e){return e!=="super"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sup",W(this.options.HTMLAttributes,e),0]},addCommands(){return{setSuperscript:()=>({commands:e})=>e.setMark(this.name),toggleSuperscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSuperscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),Fn=Pn;function Gn({document:e,onSave:t}){const n=Qe({extensions:[Ze.configure({link:!1}),et.configure({openOnClick:!1}),At,_e.configure({resizable:!0}),Hn,Nn,Ln,jn,En.configure({nested:!0}),Dn,Bn.configure({types:["heading","paragraph"]}),tt,Vn,Fn],content:(e==null?void 0:e.content)||"",onUpdate:({editor:l})=>{t(l.getHTML())}});if(De.useEffect(()=>{n&&e&&n.commands.setContent(e.content||"")},[e==null?void 0:e.id,n]),!n)return null;const o=({onClick:l,active:r,children:s})=>y.jsx("button",{onClick:l,style:{padding:"0.5rem",border:"none",background:r?"var(--accent-color)":"transparent",color:r?"var(--accent-text)":"var(--text-primary)",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",transition:"all 0.2s"},children:s});return y.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[y.jsxs("div",{style:{padding:"0.5rem",borderBottom:"1px solid var(--border-color)",background:"var(--bg-secondary)",display:"flex",gap:"0.25rem",flexWrap:"wrap"},children:[y.jsx(o,{onClick:()=>n.chain().focus().toggleBold().run(),active:n.isActive("bold"),children:y.jsx(it,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().toggleItalic().run(),active:n.isActive("italic"),children:y.jsx(pt,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().toggleStrike().run(),active:n.isActive("strike"),children:y.jsx(wt,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().toggleUnderline().run(),active:n.isActive("underline"),children:y.jsx("span",{style:{textDecoration:"underline"},children:"U"})}),y.jsx(o,{onClick:()=>n.chain().focus().toggleCode().run(),active:n.isActive("code"),children:y.jsx(ct,{size:18})}),y.jsx("div",{style:{width:"1px",background:"var(--border-color)",margin:"0 0.25rem"}}),y.jsx(o,{onClick:()=>n.chain().focus().toggleHeading({level:1}).run(),active:n.isActive("heading",{level:1}),children:y.jsx(dt,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().toggleHeading({level:2}).run(),active:n.isActive("heading",{level:2}),children:y.jsx(ut,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().toggleHeading({level:3}).run(),active:n.isActive("heading",{level:3}),children:y.jsx(ft,{size:18})}),y.jsx("div",{style:{width:"1px",background:"var(--border-color)",margin:"0 0.25rem"}}),y.jsx(o,{onClick:()=>n.chain().focus().toggleBulletList().run(),active:n.isActive("bulletList"),children:y.jsx(ot,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().toggleOrderedList().run(),active:n.isActive("orderedList"),children:y.jsx(gt,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().toggleTaskList().run(),active:n.isActive("taskList"),children:y.jsx(at,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().toggleBlockquote().run(),active:n.isActive("blockquote"),children:y.jsx(mt,{size:18})}),y.jsx("div",{style:{width:"1px",background:"var(--border-color)",margin:"0 0.25rem"}}),y.jsx(o,{onClick:()=>n.chain().focus().toggleHighlight().run(),active:n.isActive("highlight"),children:y.jsx(ht,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().setTextAlign("left").run(),active:n.isActive({textAlign:"left"}),children:y.jsx(rt,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().setTextAlign("center").run(),active:n.isActive({textAlign:"center"}),children:y.jsx(lt,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().setTextAlign("right").run(),active:n.isActive({textAlign:"right"}),children:y.jsx(st,{size:18})}),y.jsx("div",{style:{width:"1px",background:"#4a4a4a",margin:"0 0.25rem"}}),y.jsx(o,{onClick:()=>n.chain().focus().undo().run(),children:y.jsx(bt,{size:18})}),y.jsx(o,{onClick:()=>n.chain().focus().redo().run(),children:y.jsx(yt,{size:18})})]}),y.jsx("div",{style:{flex:1,overflow:"auto",background:"var(--bg-primary)",padding:"1rem",color:"var(--text-primary)"},children:y.jsx(nt,{editor:n})})]})}export{Gn as default};
//# sourceMappingURL=Editor-CnvozhSP.js.map
