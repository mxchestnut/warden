import{r as p,a as u,j as e}from"./index-BcQW7OjF.js";import{c as k,L as E,S as b,T,X as B}from"./Dashboard-CwAWU9Zg.js";import{U}from"./users-BQ9DKwfh.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s.SENTRY_RELEASE={id:"9100b80d8d3578ae8a7e4dcad47fa28b1cb8d4d7"}}catch{}})();try{(function(){var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},d=new s.Error().stack;d&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[d]="9f3fc8b3-ff48-45cf-86c3-142269bc137d",s._sentryDebugIdIdentifier="sentry-dbid-9f3fc8b3-ff48-45cf-86c3-142269bc137d")})()}catch{}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=k("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=k("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);function $(){var g,f;const[s,d]=p.useState([]),[l,A]=p.useState(null),[w,h]=p.useState(!0),[x,a]=p.useState(null),[r,c]=p.useState(null);p.useEffect(()=>{m()},[]);const m=async()=>{var t;try{h(!0);const[i,v]=await Promise.all([u.get("/admin/users"),u.get("/admin/stats")]);d(i.data.users),A(v.data)}catch(i){console.error("Failed to load admin data:",i),((t=i.response)==null?void 0:t.status)===403&&a({type:"error",text:"Access denied. Admin privileges required."})}finally{h(!1)}},z=async t=>{try{await u.post(`/admin/users/${t}/toggle-admin`),a({type:"success",text:"Admin status updated"}),m()}catch{a({type:"error",text:"Failed to update admin status"})}},C=async(t,i)=>{if(confirm(`Are you sure you want to delete user "${i}"? This cannot be undone.`))try{await u.delete(`/admin/users/${t}`),a({type:"success",text:`User "${i}" deleted`}),m()}catch{a({type:"error",text:"Failed to delete user"})}},D=t=>{const i=t.subscriptionEndsAt?new Date(t.subscriptionEndsAt).toISOString().split("T")[0]:new Date(Date.now()+2592e6).toISOString().split("T")[0];c({user:t,status:t.stripeSubscriptionStatus||"active",endsAt:i})},R=async()=>{if(r!=null&&r.user)try{await u.post(`/admin/users/${r.user.id}/subscription`,{status:r.status,endsAt:r.endsAt}),a({type:"success",text:"Subscription updated successfully"}),c(null),m()}catch{a({type:"error",text:"Failed to update subscription"})}},I=async()=>{if(r!=null&&r.user&&confirm(`Remove subscription for ${r.user.username}?`))try{await u.delete(`/admin/users/${r.user.id}/subscription`),a({type:"success",text:"Subscription removed"}),c(null),m()}catch{a({type:"error",text:"Failed to remove subscription"})}};return w?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"var(--bg-primary)"},children:e.jsx(E,{style:{animation:"spin 1s linear infinite"},size:32,color:"var(--accent-color)"})}):e.jsxs("div",{style:{padding:"2rem",background:"var(--bg-primary)",color:"var(--text-primary)",minHeight:"100vh",maxWidth:"1400px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h1",{style:{fontSize:"2rem",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(b,{size:32,color:"var(--accent-color)"}),"Admin Panel"]}),e.jsx("p",{style:{color:"var(--text-secondary)"},children:"Manage users, monitor platform activity, and troubleshoot accounts"})]}),x&&e.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",borderRadius:"8px",background:x.type==="success"?"#10b98120":"#ef444420",border:`1px solid ${x.type==="success"?"#10b981":"#ef4444"}`,color:x.type==="success"?"#10b981":"#ef4444"},children:x.text}),l&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[e.jsx(y,{icon:e.jsx(U,{size:24}),label:"Total Users",value:l.users}),e.jsx(y,{icon:e.jsx(b,{size:24}),label:"Admins",value:l.admins}),e.jsx(y,{icon:e.jsx(j,{size:24}),label:"Characters",value:l.characters}),e.jsx(y,{icon:e.jsx(j,{size:24}),label:"Documents",value:l.documents})]}),e.jsxs("div",{style:{background:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border-color)",fontWeight:600},children:["Users (",s.length,")"]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"var(--bg-tertiary)",borderBottom:"1px solid var(--border-color)"},children:[e.jsx("th",{style:n,children:"ID"}),e.jsx("th",{style:n,children:"Username"}),e.jsx("th",{style:n,children:"Email"}),e.jsx("th",{style:n,children:"Subscription"}),e.jsx("th",{style:n,children:"Discord"}),e.jsx("th",{style:n,children:"PathCompanion"}),e.jsx("th",{style:n,children:"Characters"}),e.jsx("th",{style:n,children:"Documents"}),e.jsx("th",{style:n,children:"Created"}),e.jsx("th",{style:n,children:"Actions"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)",background:t.isAdmin?"var(--accent-light)":"transparent"},children:[e.jsx("td",{style:o,children:t.id}),e.jsxs("td",{style:o,children:[t.username,t.isAdmin&&e.jsx("span",{style:{marginLeft:"0.5rem",padding:"2px 6px",fontSize:"0.75rem",background:"var(--accent-color)",color:"var(--accent-text)",borderRadius:"4px"},children:"ADMIN"})]}),e.jsx("td",{style:o,children:t.email||"-"}),e.jsx("td",{style:o,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("div",{children:[t.stripeSubscriptionStatus?e.jsx("span",{style:{padding:"2px 8px",fontSize:"0.75rem",background:t.stripeSubscriptionStatus==="active"?"#10b98120":"#ef444420",color:t.stripeSubscriptionStatus==="active"?"#10b981":"#ef4444",borderRadius:"4px",textTransform:"uppercase"},children:t.stripeSubscriptionStatus}):"-",t.subscriptionEndsAt&&e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-secondary)",marginTop:"2px"},children:new Date(t.subscriptionEndsAt).toLocaleDateString()})]}),e.jsx("button",{onClick:()=>D(t),style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem",background:"var(--accent-color)",color:"var(--accent-text)",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.25rem"},title:"Gift/Edit Subscription",children:e.jsx(S,{size:14})})]})}),e.jsx("td",{style:o,children:t.discordUserId?"âœ“":"-"}),e.jsx("td",{style:o,children:t.pathCompanionUsername||"-"}),e.jsx("td",{style:o,children:t.characterCount}),e.jsx("td",{style:o,children:t.documentCount}),e.jsx("td",{style:o,children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("td",{style:o,children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>z(t.id),style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem",background:t.isAdmin?"var(--bg-tertiary)":"var(--accent-color)",color:t.isAdmin?"var(--text-primary)":"var(--accent-text)",border:"1px solid var(--border-color)",borderRadius:"4px",cursor:"pointer"},children:e.jsx(b,{size:14})}),e.jsx("button",{onClick:()=>C(t.id,t.username),style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem",background:"#ef444420",color:"#ef4444",border:"1px solid #ef4444",borderRadius:"4px",cursor:"pointer"},children:e.jsx(T,{size:14})})]})})]},t.id))})]})})]}),r&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",padding:"2rem",maxWidth:"500px",width:"90%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("h2",{style:{margin:0,color:"var(--text-primary)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(S,{size:24,color:"var(--accent-color)"}),"Manage Subscription: ",(g=r.user)==null?void 0:g.username]}),e.jsx("button",{onClick:()=>c(null),style:{background:"none",border:"none",cursor:"pointer",padding:"0.5rem",color:"var(--text-secondary)"},children:e.jsx(B,{size:20})})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-primary)",fontWeight:500},children:"Status"}),e.jsxs("select",{value:r.status,onChange:t=>c({...r,status:t.target.value}),style:{width:"100%",padding:"0.75rem",background:"var(--bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"4px",color:"var(--text-primary)",fontSize:"1rem"},children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"canceled",children:"Canceled"}),e.jsx("option",{value:"past_due",children:"Past Due"}),e.jsx("option",{value:"unpaid",children:"Unpaid"}),e.jsx("option",{value:"trialing",children:"Trialing"})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-primary)",fontWeight:500},children:"Expires At"}),e.jsx("input",{type:"date",value:r.endsAt,onChange:t=>c({...r,endsAt:t.target.value}),style:{width:"100%",padding:"0.75rem",background:"var(--bg-tertiary)",border:"1px solid var(--border-color)",borderRadius:"4px",color:"var(--text-primary)",fontSize:"1rem"}})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[e.jsx("button",{onClick:R,style:{flex:1,padding:"0.75rem",background:"var(--accent-color)",color:"var(--accent-text)",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:600},children:"Save Subscription"}),((f=r.user)==null?void 0:f.stripeSubscriptionStatus)&&e.jsx("button",{onClick:I,style:{padding:"0.75rem 1rem",background:"#ef444420",color:"#ef4444",border:"1px solid #ef4444",borderRadius:"4px",cursor:"pointer",fontWeight:600},children:"Remove"})]})]})})]})}function y({icon:s,label:d,value:l}){return e.jsxs("div",{style:{background:"var(--bg-secondary)",padding:"1.5rem",borderRadius:"8px",border:"1px solid var(--border-color)",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsx("div",{style:{color:"var(--accent-color)"},children:s}),e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"var(--text-primary)"},children:l}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:d})]})}const n={padding:"0.75rem 1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)"},o={padding:"0.75rem 1rem",fontSize:"0.875rem",color:"var(--text-primary)"};export{$ as default};
//# sourceMappingURL=AdminPanel-UQl3ijnN.js.map
