import{j as r,r as n,b as ne,a as j}from"./index-BcQW7OjF.js";import{c as L,U as le,L as M,F as H,B as Y,D as G,T as Q,C as de,X as ce,a as pe}from"./Dashboard-CwAWU9Zg.js";import{L as me}from"./list-Cf5cEqwx.js";import{S as ge}from"./search-DSl6THef.js";import{E as V}from"./eye-ievLpwcm.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};o.SENTRY_RELEASE={id:"9100b80d8d3578ae8a7e4dcad47fa28b1cb8d4d7"}}catch{}})();try{(function(){var o=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},p=new o.Error().stack;p&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[p]="517304dd-c0dd-4b89-a28b-184454c133e0",o._sentryDebugIdIdentifier="sentry-dbid-517304dd-c0dd-4b89-a28b-184454c133e0")})()}catch{}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=L("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=L("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=L("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),q=({width:o="100%",height:p="20px",borderRadius:z="4px",count:u=1})=>{const c={width:o,height:p,borderRadius:z,backgroundColor:"#e0e0e0",backgroundImage:"linear-gradient(90deg, #e0e0e0 0%, #f0f0f0 50%, #e0e0e0 100%)",backgroundSize:"200% 100%",animation:"shimmer 1.5s infinite"},T=Array.from({length:u},(l,w)=>r.jsx("div",{style:{...c,marginBottom:u>1?"0.5rem":"0"}},w));return r.jsxs(r.Fragment,{children:[T,r.jsx("style",{children:`
        @keyframes shimmer {
          0% { background-position: -200% 0; }
          100% { background-position: 200% 0; }
        }
      `})]})};function we(){const[o,p]=n.useState([]),[z,u]=n.useState(!0),[c,T]=n.useState(!1),[l,w]=n.useState(null),[R,K]=n.useState(""),[m,X]=n.useState("all"),[I,B]=n.useState(!1),[d,k]=n.useState(null),[A,x]=n.useState([]),[y,J]=n.useState("grid"),F=n.useRef(null),S=n.useRef(0),{showToast:h,showError:D}=ne();n.useEffect(()=>{P()},[]);const P=async()=>{u(!0);try{const e=await j.get("/files");p(e.data.files)}catch(e){D(e,"Failed to load files")}finally{u(!1)}},Z=async e=>{const t=A.length;x(a=>[...a,{name:e.name,progress:0,status:"uploading"}]);try{const a=new FormData;return a.append("file",e),await j.post("/files/upload",a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:s=>{if(s.total){const i=Math.round(s.loaded*100/s.total);x(v=>v.map((O,ie)=>ie===t?{...O,progress:i}:O))}}}),x(s=>s.map((i,v)=>v===t?{...i,status:"complete",progress:100}:i)),!0}catch{return x(s=>s.map((i,v)=>v===t?{...i,status:"error"}:i)),!1}},W=async e=>{if(!e||e.length===0)return;T(!0);const t=Array.from(e);let a=0;for(const s of t)await Z(s)&&a++;a===t.length?h("success",`✅ Successfully uploaded ${a} file(s)`):h("warning",`⚠️ Uploaded ${a} of ${t.length} file(s)`),setTimeout(()=>x([]),3e3)},ee=e=>{W(e.target.files),F.current&&(F.current.value="")},re=e=>{e.preventDefault(),e.stopPropagation(),S.current++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&B(!0)},te=e=>{e.preventDefault(),e.stopPropagation(),S.current--,S.current===0&&B(!1)},oe=e=>{e.preventDefault(),e.stopPropagation()},ae=e=>{e.preventDefault(),e.stopPropagation(),B(!1),S.current=0;const t=e.dataTransfer.files;W(t)},N=async e=>{try{const t=await j.get(`/files/${e.id}/download`),{downloadUrl:a,fileName:s}=t.data,i=document.createElement("a");i.href=a,i.download=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),h("success",`Downloaded ${e.originalFileName}`)}catch(t){D(t,"Failed to download file")}},U=async e=>{if(confirm(`Delete "${e.originalFileName}"?`))try{await j.delete(`/files/${e.id}`),h("success",`Deleted ${e.originalFileName}`),await P()}catch(t){D(t,"Failed to delete file")}},$=async e=>{w(e.id);try{await j.post(`/files/${e.id}/learn`),h("success","PDF content learned successfully!")}catch(t){D(t,"Failed to learn from PDF")}finally{w(null)}},E=e=>{if(e===0)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(e)/Math.log(t));return Math.round(e/Math.pow(t,s)*100)/100+" "+a[s]},_=e=>e.mimeType.startsWith("image/")?r.jsx(ye,{size:20}):e.mimeType==="application/pdf"?r.jsx(H,{size:20}):r.jsx(pe,{size:20}),C=e=>e.category?e.category:e.mimeType.startsWith("image/")?"image":e.mimeType==="application/pdf"?"document":"other",b=o.filter(e=>{const t=e.originalFileName.toLowerCase().includes(R.toLowerCase()),a=m==="all"||C(e)===m;return t&&a}),se=[{value:"all",label:"All Files",count:o.length},{value:"image",label:"Images",count:o.filter(e=>C(e)==="image").length},{value:"document",label:"Documents",count:o.filter(e=>C(e)==="document").length},{value:"other",label:"Other",count:o.filter(e=>C(e)==="other").length}],f=e=>e.startsWith("image/"),g=e=>e==="application/pdf";return r.jsxs("div",{style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},onDragEnter:re,onDragOver:oe,onDragLeave:te,onDrop:ae,children:[r.jsxs("div",{style:{marginBottom:"2rem"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[r.jsxs("div",{children:[r.jsxs("h1",{style:{margin:0,color:"var(--text-primary)",fontSize:"2rem"},children:[r.jsx(ue,{size:32,style:{verticalAlign:"middle",marginRight:"0.5rem"}}),"File Manager"]}),r.jsxs("p",{style:{color:"var(--text-secondary)",margin:"0.5rem 0 0 0"},children:[b.length," file",b.length!==1?"s":""]})]}),r.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:r.jsx("button",{onClick:()=>J(y==="grid"?"list":"grid"),style:{padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--border-color)",background:"var(--bg-secondary)",color:"var(--text-primary)",cursor:"pointer"},title:`Switch to ${y==="grid"?"list":"grid"} view`,children:y==="grid"?r.jsx(me,{size:20}):r.jsx(xe,{size:20})})})]}),r.jsxs("div",{style:{position:"relative",padding:"2rem",borderRadius:"8px",border:I?"2px dashed var(--accent-color)":"2px dashed var(--border-color)",background:I?"rgba(220, 20, 60, 0.05)":"var(--bg-secondary)",textAlign:"center",marginBottom:"1.5rem",transition:"all 0.2s"},children:[r.jsx("input",{ref:F,type:"file",onChange:ee,multiple:!0,disabled:c,style:{display:"none"}}),r.jsx(le,{size:48,style:{color:"var(--accent-color)",marginBottom:"1rem"}}),r.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--text-primary)"},children:I?"Drop files here":"Upload Files"}),r.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"1rem"},children:"Drag and drop files here, or click to browse"}),r.jsx("button",{onClick:()=>{var e;return(e=F.current)==null?void 0:e.click()},disabled:c,style:{padding:"0.75rem 1.5rem",borderRadius:"6px",border:"none",background:c?"var(--bg-tertiary)":"var(--accent-color)",color:c?"var(--text-secondary)":"white",cursor:c?"not-allowed":"pointer",fontWeight:500,fontSize:"1rem"},children:c?r.jsxs(r.Fragment,{children:[r.jsx(M,{size:18,style:{animation:"spin 1s linear infinite",verticalAlign:"middle"}})," Uploading..."]}):"Choose Files"})]}),A.length>0&&r.jsxs("div",{style:{padding:"1rem",borderRadius:"6px",background:"var(--bg-secondary)",border:"1px solid var(--border-color)",marginBottom:"1.5rem"},children:[r.jsx("h4",{style:{margin:"0 0 0.75rem 0",color:"var(--text-primary)"},children:"Uploading Files"}),A.map((e,t)=>r.jsxs("div",{style:{marginBottom:"0.5rem"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.25rem",fontSize:"0.9rem"},children:[r.jsx("span",{style:{color:"var(--text-primary)"},children:e.name}),r.jsx("span",{style:{color:e.status==="complete"?"#10b981":e.status==="error"?"#ef4444":"var(--text-secondary)"},children:e.status==="complete"?"✓ Complete":e.status==="error"?"✗ Failed":`${e.progress}%`})]}),r.jsx("div",{style:{height:"4px",background:"var(--bg-tertiary)",borderRadius:"2px",overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${e.progress}%`,background:e.status==="error"?"#ef4444":e.status==="complete"?"#10b981":"var(--accent-color)",transition:"width 0.3s"}})})]},t))]}),r.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:1,minWidth:"200px",position:"relative"},children:[r.jsx(ge,{size:18,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-secondary)"}}),r.jsx("input",{type:"text",placeholder:"Search files...",value:R,onChange:e=>K(e.target.value),style:{width:"100%",padding:"0.75rem 0.75rem 0.75rem 2.5rem",borderRadius:"6px",border:"1px solid var(--border-color)",background:"var(--bg-secondary)",color:"var(--text-primary)",fontSize:"0.95rem"}})]}),r.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:se.map(e=>r.jsxs("button",{onClick:()=>X(e.value),style:{padding:"0.75rem 1rem",borderRadius:"6px",border:"1px solid var(--border-color)",background:m===e.value?"var(--accent-color)":"var(--bg-secondary)",color:m===e.value?"white":"var(--text-primary)",cursor:"pointer",fontWeight:m===e.value?600:400,fontSize:"0.9rem"},children:[e.label," (",e.count,")"]},e.value))})]})]}),z?y==="grid"?r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"1rem"},children:Array.from({length:6}).map((e,t)=>r.jsx(q,{height:"250px",borderRadius:"8px"},t))}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Array.from({length:8}).map((e,t)=>r.jsx(q,{height:"60px",borderRadius:"6px"},t))}):b.length===0?r.jsxs("div",{style:{textAlign:"center",padding:"4rem 2rem",background:"var(--bg-secondary)",borderRadius:"8px",border:"1px dashed var(--border-color)"},children:[r.jsx(H,{size:64,style:{color:"var(--text-secondary)",marginBottom:"1rem"}}),r.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--text-primary)"},children:"No files found"}),r.jsx("p",{style:{color:"var(--text-secondary)"},children:R||m!=="all"?"Try adjusting your filters":"Upload your first file to get started"})]}):y==="grid"?r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"1rem"},children:b.map(e=>r.jsxs("div",{style:{background:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",overflow:"hidden",cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:t=>{t.currentTarget.style.transform="translateY(-4px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"},onMouseLeave:t=>{t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none"},children:[r.jsxs("div",{style:{height:"150px",background:"var(--bg-tertiary)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},onClick:()=>f(e.mimeType)||g(e.mimeType)?k(e):null,children:[f(e.mimeType)&&e.thumbnailUrl?r.jsx("img",{src:e.thumbnailUrl,alt:e.originalFileName,style:{width:"100%",height:"100%",objectFit:"cover"}}):r.jsx("div",{style:{color:"var(--text-secondary)"},children:_(e)}),(f(e.mimeType)||g(e.mimeType))&&r.jsx("div",{style:{position:"absolute",top:"0.5rem",right:"0.5rem",background:"rgba(0,0,0,0.6)",borderRadius:"50%",padding:"0.25rem",color:"white"},children:r.jsx(V,{size:16})})]}),r.jsxs("div",{style:{padding:"1rem"},children:[r.jsx("div",{style:{fontSize:"0.9rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.5rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:e.originalFileName,children:e.originalFileName}),r.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"0.75rem"},children:E(e.fileSize)}),r.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"space-between"},children:[g(e.mimeType)&&r.jsx("button",{onClick:t=>{t.stopPropagation(),$(e)},disabled:l===e.id,style:{flex:1,padding:"0.5rem",borderRadius:"4px",border:"none",background:l===e.id?"var(--bg-tertiary)":"var(--accent-color)",color:l===e.id?"var(--text-secondary)":"white",cursor:l===e.id?"not-allowed":"pointer",fontSize:"0.85rem"},title:"Learn from PDF",children:l===e.id?r.jsx(M,{size:14,style:{animation:"spin 1s linear infinite"}}):r.jsx(Y,{size:14})}),r.jsx("button",{onClick:t=>{t.stopPropagation(),N(e)},style:{flex:1,padding:"0.5rem",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--bg-secondary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"0.85rem"},title:"Download",children:r.jsx(G,{size:14})}),r.jsx("button",{onClick:t=>{t.stopPropagation(),U(e)},style:{flex:1,padding:"0.5rem",borderRadius:"4px",border:"1px solid #ef4444",background:"transparent",color:"#ef4444",cursor:"pointer",fontSize:"0.85rem"},title:"Delete",children:r.jsx(Q,{size:14})})]})]})]},e.id))}):r.jsx("div",{style:{background:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",overflow:"hidden"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-tertiary)",borderBottom:"1px solid var(--border-color)"},children:[r.jsx("th",{style:{padding:"1rem",textAlign:"left",color:"var(--text-primary)",fontWeight:600},children:"Name"}),r.jsx("th",{style:{padding:"1rem",textAlign:"left",color:"var(--text-primary)",fontWeight:600},children:"Size"}),r.jsx("th",{style:{padding:"1rem",textAlign:"left",color:"var(--text-primary)",fontWeight:600},children:"Uploaded"}),r.jsx("th",{style:{padding:"1rem",textAlign:"left",color:"var(--text-primary)",fontWeight:600},children:"Status"}),r.jsx("th",{style:{padding:"1rem",textAlign:"left",color:"var(--text-primary)",fontWeight:600},children:"Actions"})]})}),r.jsx("tbody",{children:b.map(e=>r.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[r.jsx("td",{style:{padding:"1rem",color:"var(--text-primary)"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[_(e),r.jsx("span",{children:e.originalFileName})]})}),r.jsx("td",{style:{padding:"1rem",color:"var(--text-secondary)"},children:E(e.fileSize)}),r.jsx("td",{style:{padding:"1rem",color:"var(--text-secondary)"},children:new Date(e.uploadedAt).toLocaleDateString()}),r.jsx("td",{style:{padding:"1rem"},children:r.jsxs("span",{style:{padding:"0.25rem 0.5rem",borderRadius:"4px",background:e.virusScanStatus==="clean"?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",color:e.virusScanStatus==="clean"?"#10b981":"#ef4444",fontSize:"0.85rem",display:"inline-flex",alignItems:"center",gap:"0.25rem"},children:[e.virusScanStatus==="clean"&&r.jsx(de,{size:14}),e.virusScanStatus]})}),r.jsx("td",{style:{padding:"1rem"},children:r.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[(f(e.mimeType)||g(e.mimeType))&&r.jsx("button",{onClick:()=>k(e),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--bg-secondary)",color:"var(--text-primary)",cursor:"pointer"},title:"Preview",children:r.jsx(V,{size:16})}),g(e.mimeType)&&r.jsx("button",{onClick:()=>$(e),disabled:l===e.id,style:{padding:"0.5rem",borderRadius:"4px",border:"none",background:l===e.id?"var(--bg-tertiary)":"var(--accent-color)",color:l===e.id?"var(--text-secondary)":"white",cursor:l===e.id?"not-allowed":"pointer"},title:"Learn from PDF",children:l===e.id?r.jsx(M,{size:16,style:{animation:"spin 1s linear infinite"}}):r.jsx(Y,{size:16})}),r.jsx("button",{onClick:()=>N(e),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--bg-secondary)",color:"var(--text-primary)",cursor:"pointer"},title:"Download",children:r.jsx(G,{size:16})}),r.jsx("button",{onClick:()=>U(e),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ef4444",background:"transparent",color:"#ef4444",cursor:"pointer"},title:"Delete",children:r.jsx(Q,{size:16})})]})})]},e.id))})]})}),d&&r.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.9)",display:"flex",flexDirection:"column",zIndex:3e3},onClick:()=>k(null),children:[r.jsxs("div",{style:{padding:"1rem 2rem",background:"rgba(0,0,0,0.8)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0,color:"white"},children:d.originalFileName}),r.jsx("button",{onClick:()=>k(null),style:{background:"transparent",border:"none",color:"white",cursor:"pointer"},children:r.jsx(ce,{size:24})})]}),r.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},onClick:e=>e.stopPropagation(),children:f(d.mimeType)?r.jsx("img",{src:d.thumbnailUrl||`/api/files/${d.id}/download`,alt:d.originalFileName,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}):g(d.mimeType)?r.jsx("iframe",{src:`/api/files/${d.id}/download`,style:{width:"100%",height:"100%",border:"none"},title:d.originalFileName}):null})]}),r.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}export{we as default};
//# sourceMappingURL=FileManager-v2GMjy71.js.map
