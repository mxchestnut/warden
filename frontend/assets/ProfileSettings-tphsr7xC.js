import{r as n,j as e}from"./editor-B5c-jJ5G.js";import{a as S}from"./index-DLnxcDy-.js";import{N as C}from"./Navigation-dBEDkq4m.js";import{k as D,l as A,m as F}from"./lucide-DCJ7xeJN.js";import"./matrix-DowZW4Yz.js";function O(){const[r,j]=n.useState(null),[B,u]=n.useState(!0),[t,h]=n.useState("profile"),[R,U]=n.useState(!1),[g,a]=n.useState(null),[y,c]=n.useState(null),[s,x]=n.useState(""),[l,m]=n.useState(""),[i,d]=n.useState(!1),[b,f]=n.useState(!1);n.useEffect(()=>{p()},[]);const p=async()=>{try{u(!0);const o=await S.getCurrentUser();o&&j({...o,pathCompanionConnected:!!o.pathcompanionUsername,pathCompanionUsername:o.pathcompanionUsername||""})}catch(o){console.error("Failed to load user:",o),a("Failed to load profile")}finally{u(!1)}},w=async()=>{if(!s||!l){a("Please enter both username and password");return}try{d(!0),a(null),c(null);const o=await fetch("/api/auth/pathcompanion/connect",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:s,password:l})});if(!o.ok){const P=await o.json();throw new Error(P.error||"Failed to connect PathCompanion account")}const E=await o.json();c("PathCompanion account connected successfully!"),m(""),await p()}catch(o){a(o instanceof Error?o.message:"Failed to connect PathCompanion")}finally{d(!1)}},v=async()=>{if(confirm("Are you sure you want to disconnect your PathCompanion account?"))try{if(d(!0),a(null),c(null),!(await fetch("/api/auth/pathcompanion/disconnect",{method:"POST",credentials:"include"})).ok)throw new Error("Failed to disconnect PathCompanion account");c("PathCompanion account disconnected successfully"),x(""),m(""),await p()}catch(o){a(o instanceof Error?o.message:"Failed to disconnect PathCompanion")}finally{d(!1)}},k=async()=>{r?.id&&(await navigator.clipboard.writeText(r.id.toString()),f(!0),setTimeout(()=>f(!1),2e3))};return B?e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#37322E"},children:[e.jsx(C,{user:r}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:"4rem"},children:e.jsx("p",{style:{color:"white"},children:"Loading..."})})]}):e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#37322E"},children:[e.jsx(C,{user:r}),e.jsxs("div",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h1",{style:{fontSize:"2rem",fontWeight:"bold",color:"white",marginBottom:"0.5rem"},children:"Profile & Settings"}),e.jsx("p",{style:{color:"#B3B2B0"},children:"Manage your account settings and integrations"})]}),g&&e.jsx("div",{style:{backgroundColor:"#7F1D1D",color:"white",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1rem"},children:g}),y&&e.jsx("div",{style:{backgroundColor:"#065F46",color:"white",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1rem"},children:y}),e.jsx("div",{style:{borderBottom:"2px solid #4A4540",marginBottom:"2rem"},children:e.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[e.jsx("button",{onClick:()=>h("profile"),style:{padding:"1rem",color:t==="profile"?"#D4AF37":"#B3B2B0",borderBottom:t==="profile"?"2px solid #D4AF37":"none",background:"none",border:"none",cursor:"pointer",fontWeight:t==="profile"?"bold":"normal"},children:"Profile"}),e.jsx("button",{onClick:()=>h("pathcompanion"),style:{padding:"1rem",color:t==="pathcompanion"?"#D4AF37":"#B3B2B0",borderBottom:t==="pathcompanion"?"2px solid #D4AF37":"none",background:"none",border:"none",cursor:"pointer",fontWeight:t==="pathcompanion"?"bold":"normal"},children:"PathCompanion"})]})}),t==="profile"&&r&&e.jsxs("div",{style:{backgroundColor:"#4A4540",borderRadius:"0.75rem",padding:"2rem"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"white",marginBottom:"1.5rem"},children:"Account Information"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#B3B2B0",marginBottom:"0.5rem"},children:"Username"}),e.jsx("input",{type:"text",value:r.username,disabled:!0,style:{width:"100%",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #666",backgroundColor:"#333",color:"#888",cursor:"not-allowed"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#B3B2B0",marginBottom:"0.5rem"},children:"Account ID"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:"text",value:r.id,readOnly:!0,onClick:o=>o.currentTarget.select(),style:{width:"100%",padding:"0.75rem",paddingRight:"3rem",borderRadius:"0.5rem",border:"1px solid #666",backgroundColor:"#333",color:"#D4AF37",fontWeight:"bold",fontSize:"1.1rem",cursor:"text",userSelect:"all"}}),e.jsx("button",{onClick:k,style:{position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",backgroundColor:b?"#065F46":"#B34B0C",color:"white",padding:"0.5rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.25rem",transition:"background-color 0.2s"},title:"Copy Account ID",children:b?e.jsx(D,{className:"w-4 h-4"}):e.jsx(A,{className:"w-4 h-4"})})]}),e.jsx("p",{style:{color:"#B3B2B0",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Use this ID in Discord to sync your profile with the Warden bot"})]}),r.isAdmin&&e.jsx("div",{style:{backgroundColor:"#B34B0C",color:"white",padding:"0.75rem 1rem",borderRadius:"0.5rem",display:"inline-block"},children:e.jsx("strong",{children:"Admin Account"})})]})]}),t==="pathcompanion"&&e.jsxs("div",{style:{backgroundColor:"#4A4540",borderRadius:"0.75rem",padding:"2rem"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"white",marginBottom:"1rem"},children:"PathCompanion Integration"}),e.jsx("p",{style:{color:"#B3B2B0",marginBottom:"1.5rem"},children:"Connect your PathCompanion account to sync characters and access game features."}),r?.pathCompanionConnected?e.jsxs("div",{children:[e.jsxs("div",{style:{backgroundColor:"#065F46",color:"white",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(F,{className:"w-5 h-5"}),e.jsxs("span",{children:["Connected as ",e.jsx("strong",{children:r.pathCompanionUsername})]})]}),e.jsx("button",{onClick:v,disabled:i,style:{backgroundColor:"#7F1D1D",color:"white",padding:"0.75rem 1.5rem",borderRadius:"0.5rem",border:"none",cursor:i?"not-allowed":"pointer",opacity:i?.6:1},children:i?"Disconnecting...":"Disconnect PathCompanion"})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#B3B2B0",marginBottom:"0.5rem"},children:"PathCompanion Username"}),e.jsx("input",{type:"text",value:s,onChange:o=>x(o.target.value),placeholder:"Enter your PathCompanion username",style:{width:"100%",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #666",backgroundColor:"#333",color:"white"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"#B3B2B0",marginBottom:"0.5rem"},children:"PathCompanion Password"}),e.jsx("input",{type:"password",value:l,onChange:o=>m(o.target.value),placeholder:"Enter your PathCompanion password",style:{width:"100%",padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #666",backgroundColor:"#333",color:"white"}})]}),e.jsx("button",{onClick:w,disabled:i||!s||!l,style:{backgroundColor:"#B34B0C",color:"white",padding:"0.75rem 1.5rem",borderRadius:"0.5rem",border:"none",cursor:i||!s||!l?"not-allowed":"pointer",opacity:i||!s||!l?.6:1},children:i?"Connecting...":"Connect PathCompanion"})]})]})]})]})}export{O as ProfileSettings};
